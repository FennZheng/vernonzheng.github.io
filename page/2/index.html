<!doctype html>
<html class="theme-next use-motion theme-next-mist">
<head>
  

<meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>






  <link rel="stylesheet" type="text/css" href="/vendors/fancybox/source/jquery.fancybox.css?v=2.1.5"/>


<link rel="stylesheet" type="text/css" href="/css/main.css?v=0.4.3"/>


    <meta name="description" content="tech | life | thiking | note" />



  <meta name="keywords" content="Hexo,next" />



  <link rel="alternate" href="/atom.xml" title="Vern Zheng" type="application/atom+xml" />



  <link rel="shorticon icon" type="image/x-icon" href="/img/favicon.ico?v=0.4.3" />



<script type="text/javascript" id="hexo.configuration">
  var CONFIG = {
    scheme: 'Mist',
    analytics: {
      google: ''
    },
    sidebar: 'post'
  };
</script>


  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "//hm.baidu.com/hm.js?1c6aeb80f79b63b35b25a0e55ca39b3c";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>



  <title> Vern Zheng </title>
</head>

<body>
<!--[if lte IE 8]> <div style=' clear: both; height: 59px; padding:0 0 0 15px; position: relative;margin:0 auto;'> <a href="http://windows.microsoft.com/en-US/internet-explorer/products/ie/home?ocid=ie6_countdown_bannercode"><img src="http://7u2nvr.com1.z0.glb.clouddn.com/picouterie.jpg" border="0" height="42" width="820" alt="You are using an outdated browser. For a faster, safer browsing experience, upgrade for free today or use other browser ,like chrome firefox safari." style='margin-left:auto;margin-right:auto;display: block;'/></a></div> <![endif]-->
  <div class="container one-column 
   page-home 
">
    <div class="headband"></div>

    <div id="header" class="header">
      <div class="header-inner">
        <h1 class="site-meta">
  <span class="logo-line-before"><i></i></span>
  <a href="/" class="brand">
      <span class="logo">
        <i class="icon-logo"></i>
      </span>
      <span class="site-title">Vern Zheng</span>
  </a>
  <span class="logo-line-after"><i></i></span>
</h1>


  <ul id="menu" class="menu">
     
    <!--增加swiftype搜索功能-->
    <form class="menu-item menu-item-search">
      <input type="text" id="st-search-input" class="st-search-input st-default-search-input" />
    </form>
    
    <script type="text/javascript">
      (function(w,d,t,u,n,s,e){w['SwiftypeObject']=n;w[n]=w[n]||function(){
      (w[n].q=w[n].q||[]).push(arguments);};s=d.createElement(t);
      e=d.getElementsByTagName(t)[0];s.async=1;s.src=u;e.parentNode.insertBefore(s,e);
      })(window,document,'script','//s.swiftypecdn.com/install/v2/st.js','_st');

      _st('install','bNJLpWscccCpxDj9sAMC','2.0.0');
    </script>
    <!--增加swiftype搜索功能end-->
    
    
      
      <li class="menu-item menu-item-home">
        <a href="/">
          <i class="menu-item-icon icon-home"></i> <br />
          Home
        </a>
      </li>
    
      
      <li class="menu-item menu-item-categories">
        <a href="/categories">
          <i class="menu-item-icon icon-categories"></i> <br />
          Categories
        </a>
      </li>
    
      
      <li class="menu-item menu-item-archives">
        <a href="/archives">
          <i class="menu-item-icon icon-archives"></i> <br />
          Archives
        </a>
      </li>
    
      
      <li class="menu-item menu-item-tags">
        <a href="/tags">
          <i class="menu-item-icon icon-tags"></i> <br />
          Tags
        </a>
      </li>
    
      
      <li class="menu-item menu-item-about">
        <a href="/about">
          <i class="menu-item-icon icon-about"></i> <br />
          About
        </a>
      </li>
    
  </ul>


      </div>
    </div>

    <div id="main" class="main">
      <div class="main-inner">
        <div id="content" class="content">
          
  <div id="posts" class="posts-expand">
    
      

  <div class="post post-type-normal ">
    <div class="post-header">

      
      
        <h1 class="post-title">
          
          
            
              <a class="post-title-link" href="/2015/02/03/《快学scala》习题解答-第十一章-操作符/">
                《快学scala》习题解答-第十一章-操作符
              </a>
            
          
        </h1>
      

      <div class="post-meta">
        <span class="post-time">
          Posted on 2015-02-03
        </span>

        
          <span class="post-category">
            &nbsp; | &nbsp; In
            
              <a href="/categories/scala/">scala</a>

              
              

            
          </span>
        

        
          
            <span class="post-comments-count">
            &nbsp; | &nbsp;
            <a href="/2015/02/03/《快学scala》习题解答-第十一章-操作符/#comments" >
              <span class="post-comments-count ds-thread-count" data-thread-key="2015/02/03/《快学scala》习题解答-第十一章-操作符/"></span>
            </a>
          </span>
          
        
      </div>
    </div>

    <div class="post-body">

      
      

      
        
          <pre><code>《快学Scala》（英文版：《Scala <span class="keyword">for</span> <span class="operator">the</span> Impatient》），代码已传github：
</code></pre><p><a href="https://github.com/vernonzheng/scala-for-the-Impatient" target="_blank" rel="external">https://github.com/vernonzheng/scala-for-the-Impatient</a></p>
<p>书为第一版。scala为2.11.4，jdk1.7.45，操作系统Mac OS X Yosemite 10.10.1。</p>
<h2 id="第十一章_操作符">第十一章 操作符</h2>
<p><strong>11.1</strong><br>根据优先级规则,3 + 4 -&gt; 5和3 -&gt; 4 + 5是如何被求值的？</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">scala&gt; <span class="number">3</span>+<span class="number">4</span>-&gt;<span class="number">5</span></div><div class="line">res0: (Int, Int) = (<span class="number">7</span>,<span class="number">5</span>)</div><div class="line"></div><div class="line">scala&gt; <span class="number">3</span>-&gt;<span class="number">4</span>+<span class="number">5</span></div><div class="line">&lt;console&gt;:<span class="number">8</span>: error: <span class="keyword">type</span> mismatch;</div><div class="line"> found   : Int(<span class="number">5</span>)</div><div class="line"> required: String</div><div class="line">              <span class="number">3</span>-&gt;<span class="number">4</span>+<span class="number">5</span></div><div class="line">                   ^</div></pre></td></tr></table></figure>

<p><strong>11.2</strong><br>BigInt类有一个pow方法,但没有用操作符字符。Scala类库的设计者为什么没有选用**(像Fortran那样)或者^(像Pascal那样)作为乘方操作符呢？</p>
<p>Scala中的操作符就是方法，其优先级是根据首字母来判断的，优先级如下<br>最高优先级:除以下字符外的操作符字符</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">* / % </div><div class="line">+ - </div><div class="line">: </div><div class="line">= ! </div><div class="line">&lt; &gt; </div><div class="line">& </div><div class="line">ˆ </div><div class="line">| </div><div class="line">非操作符</div><div class="line">最低优先级:赋值操作符</div></pre></td></tr></table></figure>

<p>一般乘方的操作符是优于乘法操作的，如果使用<em>*作为乘方的话，那么其优先级则与</em>相同，而如果使用^的话，则优先级低于*操作。优先级都是有问题的。故没有使用这两种操作符</p>
<p><strong>11.3</strong><br>实现Fraction类，支持+<em>/操作。支持约分，例如将15/-6变为-5/2。除以最大公约数,像这样:<br>class Fraction(n:Int,d:Int){<br>    private val num:Int = if(d==0) 1 else n </em> sign(d)/gcd(n,d);<br>    private val den:Int = if(d==0) 0 else d * sign(d)/gcd(n,d);<br>    override def toString = num + “/“ + den<br>    def sign(a:Int) = if(a &gt; 0) 1 else if (a &lt; 0) -1 else 0<br>    def gcd(a:Int,b:Int):Int = if(b==0) abs(a) else gcd(b,a%b)<br>    …<br>}</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div></pre></td><td class="code"><pre><div class="line">mport scala.math.abs</div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Fraction</span><span class="params">(n: Int, d: Int)</span> </span>{</div><div class="line">  <span class="keyword">private</span> <span class="keyword">val</span> num: Int = <span class="keyword">if</span> (d == <span class="number">0</span>) <span class="number">1</span> <span class="keyword">else</span> n * sign(d) / gcd(n, d);</div><div class="line">  <span class="keyword">private</span> <span class="keyword">val</span> den: Int = <span class="keyword">if</span> (d == <span class="number">0</span>) <span class="number">0</span> <span class="keyword">else</span> d * sign(d) / gcd(n, d);</div><div class="line"></div><div class="line">  <span class="keyword">override</span> <span class="keyword">def</span> toString = num + <span class="string">"/"</span> + den</div><div class="line"></div><div class="line">  <span class="keyword">def</span> sign(a: Int) = <span class="keyword">if</span> (a &gt; <span class="number">0</span>) <span class="number">1</span> <span class="keyword">else</span> <span class="keyword">if</span> (a &lt; <span class="number">0</span>) -<span class="number">1</span> <span class="keyword">else</span> <span class="number">0</span></div><div class="line"></div><div class="line">  <span class="keyword">def</span> gcd(a: Int, b: Int): Int = <span class="keyword">if</span> (b == <span class="number">0</span>) abs(a) <span class="keyword">else</span> gcd(b, a % b)</div><div class="line"></div><div class="line">  <span class="keyword">def</span> +(other:Fraction):Fraction={</div><div class="line">    newFraction((<span class="keyword">this</span>.num * other.den) + (other.num * <span class="keyword">this</span>.den),<span class="keyword">this</span>.den * other.den)</div><div class="line">  }</div><div class="line"></div><div class="line">  <span class="keyword">def</span> -(other:Fraction):Fraction={</div><div class="line">    newFraction((<span class="keyword">this</span>.num * other.den) - (other.num * <span class="keyword">this</span>.den),<span class="keyword">this</span>.den * other.den)</div><div class="line">  }</div><div class="line"></div><div class="line">  <span class="keyword">def</span> *(other:Fraction):Fraction={</div><div class="line">    newFraction(<span class="keyword">this</span>.num * other.num,<span class="keyword">this</span>.den * other.den)</div><div class="line">  }</div><div class="line"></div><div class="line">  <span class="keyword">def</span> /(other:Fraction):Fraction={</div><div class="line">    newFraction(<span class="keyword">this</span>.num * other.den,<span class="keyword">this</span>.den * other.num)</div><div class="line">  }</div><div class="line"></div><div class="line">  <span class="keyword">private</span> <span class="keyword">def</span> newFraction(a:Int,b:Int):Fraction={</div><div class="line">    <span class="keyword">val</span> x:Int = <span class="keyword">if</span> (b == <span class="number">0</span>) <span class="number">1</span> <span class="keyword">else</span> a * sign(b) / gcd(a, b)</div><div class="line">    <span class="keyword">val</span> y:Int = <span class="keyword">if</span> (b == <span class="number">0</span>) <span class="number">0</span> <span class="keyword">else</span> b * sign(b) / gcd(a, b)</div><div class="line">    <span class="keyword">new</span> Fraction(x,y)</div><div class="line">  }</div><div class="line">}</div><div class="line"><span class="class"><span class="keyword">object</span> <span class="title">Test</span> <span class="keyword">extends</span> <span class="title">App</span></span>{</div><div class="line">  <span class="keyword">val</span> f = <span class="keyword">new</span> Fraction(<span class="number">15</span>,-<span class="number">6</span>)</div><div class="line">  <span class="keyword">val</span> p = <span class="keyword">new</span> Fraction(<span class="number">20</span>,<span class="number">60</span>)</div><div class="line">  println(f)</div><div class="line">  println(p)</div><div class="line">  println(f + p)</div><div class="line">  println(f - p)</div><div class="line">  println(f * p)</div><div class="line">  println(f / p)</div><div class="line">}</div></pre></td></tr></table></figure>

<p><strong>11.4</strong><br>实现一个Money类,加入美元和美分字段。提供+,-操作符以及比较操作符==和&lt;。举例来说，Money(1,75)+Money(0,50)==Money(2,25)应为true。你应该同时提供*和/操作符吗？为什么？</p>
<p>不需要提供，金额的乘除没有实际意义。</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Money</span><span class="params">(dollar:Int,cent:Int)</span></span>{</div><div class="line">  <span class="keyword">def</span> + (other:Money):Money = {</div><div class="line">    <span class="keyword">val</span> (a,b) = (<span class="keyword">this</span>.cent + other.cent) % <span class="number">100</span></div><div class="line">    <span class="keyword">new</span> Money(<span class="keyword">this</span>.dollar + other.dollar + a,b)</div><div class="line">  }</div><div class="line">  <span class="keyword">def</span> -(other:Money):Money={</div><div class="line">    <span class="keyword">val</span> (d,c) = (<span class="keyword">this</span>.toCent() - other.toCent()) % <span class="number">100</span></div><div class="line">    <span class="keyword">new</span> Money(d,c)</div><div class="line">  }</div><div class="line">  <span class="keyword">def</span> ==(other:Money):Boolean = <span class="keyword">this</span>.dollar == other.dollar && <span class="keyword">this</span>.cent == other.cent</div><div class="line"></div><div class="line">  <span class="keyword">def</span> &lt;(other:Money):Boolean = <span class="keyword">this</span>.dollar &lt; other.dollar || (<span class="keyword">this</span>.dollar == other.dollar && <span class="keyword">this</span>.cent &lt; other.cent)</div><div class="line"></div><div class="line">  <span class="keyword">override</span> <span class="keyword">def</span> toString = <span class="string">"dollar = "</span> + dollar + <span class="string">" cent = "</span> + cent</div><div class="line"></div><div class="line">  <span class="keyword">private</span> <span class="keyword">def</span> toCent()={</div><div class="line">    <span class="keyword">this</span>.dollar * <span class="number">100</span> + <span class="keyword">this</span>.cent</div><div class="line">  }</div><div class="line">}</div><div class="line"><span class="class"><span class="keyword">object</span> <span class="title">Money</span></span>{</div><div class="line">  <span class="keyword">def</span> apply(dollar:Int, cent:Int): Money ={</div><div class="line">    <span class="keyword">new</span> Money(dollar,cent)</div><div class="line">  }</div><div class="line">  <span class="keyword">def</span> main(args:Array[String]){</div><div class="line"></div><div class="line">    <span class="keyword">val</span> m1 = Money(<span class="number">1</span>,<span class="number">200</span>)</div><div class="line">    <span class="keyword">val</span> m2 = Money(<span class="number">2</span>,<span class="number">2</span>)</div><div class="line">    println(m1 + m2)</div><div class="line">    println(m1 - m2)</div><div class="line">    println(m1 == m2)</div><div class="line">    println(m1 &lt; m2)</div><div class="line">    println(Money(<span class="number">1</span>,<span class="number">75</span>)+Money(<span class="number">0</span>,<span class="number">50</span>))</div><div class="line">    println(Money(<span class="number">1</span>,<span class="number">75</span>)+Money(<span class="number">0</span>,<span class="number">50</span>)==Money(<span class="number">2</span>,<span class="number">25</span>))</div><div class="line"></div><div class="line">  }</div><div class="line">}</div></pre></td></tr></table></figure>

<p><strong>11.5</strong><br>提供操作符用于构造HTML表格。例如:Table() | “Java” | “Scala” || “Gosling” | “Odersky” || “JVM” | “JVM,.NET”应产出:<table><tr><td>Java</td></tr><td>Scala</td><tr><td>Gosling…</td></tr></table></p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Table</span></span>{</div><div class="line"></div><div class="line">  <span class="keyword">var</span> s:String = <span class="string">""</span></div><div class="line"></div><div class="line">  <span class="keyword">def</span> |(str:String):Table={</div><div class="line">    <span class="keyword">val</span> t = Table()</div><div class="line">    t.s = <span class="keyword">this</span>.s + <span class="string">"&lt;td&gt;"</span> + str + <span class="string">"&lt;/td&gt;"</span></div><div class="line">    t</div><div class="line">  }</div><div class="line"></div><div class="line">  <span class="keyword">def</span> ||(str:String):Table={</div><div class="line">    <span class="keyword">val</span> t = Table()</div><div class="line">    t.s = <span class="keyword">this</span>.s + <span class="string">"&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;"</span> + str + <span class="string">"&lt;/td&gt;"</span></div><div class="line">    t</div><div class="line">  }</div><div class="line"></div><div class="line">  <span class="keyword">override</span> <span class="keyword">def</span> toString():String={</div><div class="line">    <span class="string">"&lt;table&gt;&lt;tr&gt;"</span> + <span class="keyword">this</span>.s + <span class="string">"&lt;/tr&gt;&lt;/table&gt;"</span></div><div class="line">  }</div><div class="line">}</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">object</span> <span class="title">Table</span></span>{</div><div class="line"></div><div class="line">  <span class="keyword">def</span> apply():Table={</div><div class="line">    <span class="keyword">new</span> Table()</div><div class="line">  }</div><div class="line"></div><div class="line">  <span class="keyword">def</span> main(args: Array[String]) {</div><div class="line">    println(Table() | <span class="string">"Java"</span> | <span class="string">"Scala"</span> || <span class="string">"Gosling"</span> | <span class="string">"Odersky"</span> || <span class="string">"JVM"</span> | <span class="string">"JVM,.NET"</span>)</div><div class="line">  }</div><div class="line">}</div></pre></td></tr></table></figure>

<p><strong>11.6</strong><br>提供一个ASCIIArt类，其对象包含类似这样的图形:<br> /_/\<br>( ‘ ‘ )<br>(  -  )<br> | | |<br>(<strong>|</strong>)<br>提供将两个ASCIIArt图形横向或纵向结合的操作符。选用适当优先级的操作符命名。纵向结合的实例<br> /_/\     ——-<br>( ‘ ‘ )  / Hello \<br>(  -  ) &lt;  Scala |<br> | | |   \ Coder /<br>(<strong>|</strong>)    ——-</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> collection.mutable.ArrayBuffer</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">ASCIIArt</span><span class="params">(str:String)</span></span>{</div><div class="line">  <span class="keyword">val</span> arr:ArrayBuffer[ArrayBuffer[String]] = <span class="keyword">new</span> ArrayBuffer[ArrayBuffer[String]]()</div><div class="line"></div><div class="line">  <span class="keyword">if</span> (str != <span class="keyword">null</span> && !str.trim.eq(<span class="string">""</span>)){</div><div class="line">    str.split(<span class="string">"[\r\n]+"</span>).foreach{</div><div class="line">      line =&gt;</div><div class="line">        <span class="keyword">val</span> s = <span class="keyword">new</span> ArrayBuffer[String]()</div><div class="line">        s += line</div><div class="line">        arr += s</div><div class="line">    }</div><div class="line">  }</div><div class="line"></div><div class="line">  <span class="keyword">def</span> <span class="keyword">this</span>(){</div><div class="line">    <span class="keyword">this</span>(<span class="string">""</span>)</div><div class="line">  }</div><div class="line"></div><div class="line">  <span class="keyword">def</span> +(other:ASCIIArt):ASCIIArt={</div><div class="line">    <span class="keyword">val</span> art = <span class="keyword">new</span> ASCIIArt()</div><div class="line">    <span class="keyword">val</span> length = <span class="keyword">if</span> (<span class="keyword">this</span>.arr.length &gt;= other.arr.length) <span class="keyword">this</span>.arr.length <span class="keyword">else</span> other.arr.length</div><div class="line">    <span class="keyword">for</span>(i &lt;- <span class="number">0</span> until length){</div><div class="line">      <span class="keyword">val</span> s = <span class="keyword">new</span> ArrayBuffer[String]()</div><div class="line">      <span class="keyword">val</span> thisArr:ArrayBuffer[String] = <span class="keyword">if</span> (i &lt; <span class="keyword">this</span>.arr.length) <span class="keyword">this</span>.arr(i) <span class="keyword">else</span> <span class="keyword">new</span> ArrayBuffer[String]()</div><div class="line">      <span class="keyword">val</span> otherArr:ArrayBuffer[String] = <span class="keyword">if</span> (i &lt; other.arr.length) other.arr(i) <span class="keyword">else</span> <span class="keyword">new</span> ArrayBuffer[String]()</div><div class="line">      thisArr.foreach(s += _)</div><div class="line">      otherArr.foreach(s += _)</div><div class="line">      art.arr += s</div><div class="line">    }</div><div class="line">    art</div><div class="line">  }</div><div class="line"></div><div class="line">  <span class="keyword">def</span> *(other:ASCIIArt):ASCIIArt={</div><div class="line">    <span class="keyword">val</span> art = <span class="keyword">new</span> ASCIIArt()</div><div class="line">    <span class="keyword">this</span>.arr.foreach(art.arr += _)</div><div class="line">    other.arr.foreach(art.arr += _)</div><div class="line">    art</div><div class="line">  }</div><div class="line"></div><div class="line">  <span class="keyword">override</span> <span class="keyword">def</span> toString()={</div><div class="line">    <span class="keyword">var</span> ss:String = <span class="string">""</span></div><div class="line">    arr.foreach{</div><div class="line">      ss += _.mkString(<span class="string">" "</span>) + <span class="string">"\n"</span></div><div class="line">    }</div><div class="line">    ss</div><div class="line">  }</div><div class="line">}</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">object</span> <span class="title">Test</span> <span class="keyword">extends</span> <span class="title">App</span></span>{</div><div class="line">  <span class="keyword">val</span> a = <span class="keyword">new</span> ASCIIArt(<span class="string">""" /\_/\</span></div><div class="line">                         |( ' ' )</div><div class="line">                         |(  -  )</div><div class="line">                         | | | |</div><div class="line">                         |(__|__)</div><div class="line">                         |""".stripMargin)</div><div class="line">  <span class="keyword">val</span> b = <span class="keyword">new</span> ASCIIArt( <span class="string">"""    -----</span></div><div class="line">                          |  / Hello \</div><div class="line">                          | &lt;  Scala |</div><div class="line">                          |  \ Coder /</div><div class="line">                          |    -----</div><div class="line">                          |""".stripMargin)</div><div class="line">  println(a + b * b)</div><div class="line">  println((a + b) * b)</div><div class="line">  println(a * b)</div><div class="line">}</div></pre></td></tr></table></figure>

<p><strong>11.7</strong><br>实现一个BigSequence类,将64个bit的序列打包在一个Long值中。提供apply和update操作来获取和设置某个具体的bit</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">BitSequence</span><span class="params">(private var value: Long = 0)</span> </span>{</div><div class="line"></div><div class="line">  implicit <span class="keyword">def</span> bool2int(b: Boolean) = <span class="keyword">if</span> (b) <span class="number">1</span> <span class="keyword">else</span> <span class="number">0</span></div><div class="line"></div><div class="line">  <span class="keyword">def</span> update(bit: Int, state: Int) = value |= (state & <span class="number">1</span>L) &lt;&lt; bit % <span class="number">64</span></div><div class="line">  <span class="keyword">def</span> apply(bit: Int): Int = <span class="keyword">if</span> ((value & <span class="number">1</span>L &lt;&lt; bit % <span class="number">64</span>) &gt; <span class="number">0</span>) <span class="number">1</span> <span class="keyword">else</span> <span class="number">0</span></div><div class="line"></div><div class="line">  <span class="keyword">override</span> <span class="keyword">def</span> toString = <span class="string">"%64s"</span>.format(value.toBinaryString).replace(<span class="string">" "</span>, <span class="string">"0"</span>)</div><div class="line">}</div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">val</span> x = <span class="keyword">new</span> BitSequence()</div><div class="line"></div><div class="line">x(<span class="number">5</span>) = <span class="number">1</span></div><div class="line">x(<span class="number">63</span>) = <span class="number">1</span></div><div class="line">x(<span class="number">64</span>) = <span class="number">1</span></div><div class="line"></div><div class="line">println(x(<span class="number">5</span>))</div><div class="line"></div><div class="line">println(x)</div></pre></td></tr></table></figure>

<p><strong>11.8</strong><br>提供一个Matrix类—你可以选择需要的是一个2<em>2的矩阵，任意大小的正方形矩阵，或m</em>n的矩阵。支持+和<em>操作。</em>操作应同样适用于单值，例如mat*2。单个元素可以通过mat(row,col)得到</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Matrix</span><span class="params">(val m: Int, val n: Int=m)</span> </span>{</div><div class="line">	</div><div class="line">	<span class="keyword">private</span> <span class="keyword">val</span> value = Array.ofDim[Double](m, n)</div><div class="line"></div><div class="line">	<span class="keyword">def</span> update(x: Int, y: Int, v: Double) = value(x)(y) = v</div><div class="line">	<span class="keyword">def</span> apply(x: Int, y: Int) = value(x)(y)</div><div class="line"></div><div class="line">	<span class="keyword">def</span> +(other: Matrix) = {</div><div class="line">		require (n == other.n)</div><div class="line">		require (m == other.m)</div><div class="line"></div><div class="line">		<span class="keyword">var</span> res = <span class="keyword">new</span> Matrix(m, n)</div><div class="line">		<span class="keyword">for</span>(i &lt;- <span class="number">0</span> until m; j &lt;- <span class="number">0</span> until n) {</div><div class="line">			res(i, j) = <span class="keyword">this</span>.value(i)(j) + other.value(i)(j)</div><div class="line">		}</div><div class="line">		res </div><div class="line">	}</div><div class="line"></div><div class="line">	<span class="keyword">def</span> -(other: Matrix) = <span class="keyword">this</span> + other * -<span class="number">1</span></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">	<span class="keyword">def</span> *(factor: Double) = {</div><div class="line">		<span class="keyword">var</span> res = <span class="keyword">new</span> Matrix(m, n)</div><div class="line">		<span class="keyword">for</span>(i &lt;- <span class="number">0</span> until m; j &lt;- <span class="number">0</span> until n) {</div><div class="line">			res(i, j) = <span class="keyword">this</span>.value(i)(j) * factor</div><div class="line">		}</div><div class="line">		res </div><div class="line">	}</div><div class="line"></div><div class="line">	<span class="keyword">private</span> <span class="keyword">def</span> prod(other: Matrix, i: Int, j: Int) = {</div><div class="line">		(<span class="keyword">for</span> (k &lt;- <span class="number">0</span> until n) <span class="keyword">yield</span> value(i)(k) * other.value(j)(k)).sum</div><div class="line">	}</div><div class="line"></div><div class="line">	<span class="keyword">def</span> *(other: Matrix) = {</div><div class="line">		require(n == other.m)</div><div class="line">		<span class="keyword">var</span> res = <span class="keyword">new</span> Matrix(m, n)</div><div class="line">		<span class="keyword">for</span>(i &lt;- <span class="number">0</span> until m; j &lt;- <span class="number">0</span> until n) {</div><div class="line">			res(i, j) = prod(other, i, j)</div><div class="line">		}</div><div class="line">		res </div><div class="line">	}</div><div class="line">	</div><div class="line">	<span class="keyword">override</span> <span class="keyword">def</span> toString = value.map(_.mkString(<span class="string">" "</span>)).mkString(<span class="string">"\n"</span>)</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keyword">val</span> x = <span class="keyword">new</span> Matrix(<span class="number">2</span>, <span class="number">2</span>)</div><div class="line">x(<span class="number">0</span>, <span class="number">0</span>) = <span class="number">1</span></div><div class="line">x(<span class="number">0</span>, <span class="number">1</span>) = <span class="number">2</span></div><div class="line">x(<span class="number">1</span>, <span class="number">0</span>) = <span class="number">3</span></div><div class="line">x(<span class="number">1</span>, <span class="number">1</span>) = <span class="number">4</span></div><div class="line"></div><div class="line">println(x)</div><div class="line">println()</div><div class="line">println(x * <span class="number">2</span>)</div><div class="line">println()</div><div class="line">println(x * <span class="number">2</span> - x)</div><div class="line">println()</div><div class="line"></div><div class="line">println((x * <span class="number">2</span>) * (x * <span class="number">3</span>))</div></pre></td></tr></table></figure>

<p><strong>11.9</strong><br>为RichFile类定义unapply操作，提取文件路径，名称和扩展名。举例来说，文件/home/cay/readme.txt的路径为/home/cay,名称为readme,扩展名为txt</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">RichFile</span><span class="params">(val path:String)</span> <span class="keyword">extends</span> <span class="title">java</span>.<span class="title">io</span>.<span class="title">File</span><span class="params">(path)</span></span>{</div><div class="line"></div><div class="line">}</div><div class="line"><span class="class"><span class="keyword">object</span> <span class="title">RichFile</span></span>{</div><div class="line">  <span class="keyword">def</span> unapply(richFile:RichFile): Unit ={</div><div class="line">    <span class="keyword">val</span> path = richFile.path</div><div class="line">    <span class="keyword">val</span> pos = path.lastIndexOf(<span class="string">"/"</span>)</div><div class="line">    <span class="keyword">if</span> (pos == -<span class="number">1</span>) None <span class="keyword">else</span> Some((path.substring(<span class="number">0</span>, pos), path.substring(pos + <span class="number">1</span>)))</div><div class="line">  }</div><div class="line">}</div></pre></td></tr></table></figure>

<p><strong>11.10</strong><br>为RichFile类定义一个unapplySeq，提取所有路径段。举例来说，对于/home/cay/readme.txt，你应该产出三个路径段的序列:home,cay和readme.txt</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">object</span> <span class="title">RichFile</span> </span>{</div><div class="line">  <span class="keyword">def</span> unapplySeq(s: String): Option[Seq[String]] = {</div><div class="line">    <span class="keyword">if</span> (s.trim == <span class="string">""</span>) None <span class="keyword">else</span> Some(s.trim.split(<span class="string">"/"</span>))</div><div class="line">  }</div><div class="line">}</div></pre></td></tr></table></figure>

<hr>
<p>参考：<br>《快学Scala》：<a href="http://book.douban.com/subject/19971952/" target="_blank" rel="external">http://book.douban.com/subject/19971952/</a></p>
<p><strong>（转载本站文章请注明作者和出处 Vernon Zheng(郑雪峰) – vernonzheng.com ，请勿用于任何商业用途）</strong></p>

        
      
    </div>

    <div class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </div>
  </div>


    
      

  <div class="post post-type-normal ">
    <div class="post-header">

      
      
        <h1 class="post-title">
          
          
            
              <a class="post-title-link" href="/2015/02/02/《快学scala》习题解答-第十章-特质/">
                《快学scala》习题解答-第十章-特质
              </a>
            
          
        </h1>
      

      <div class="post-meta">
        <span class="post-time">
          Posted on 2015-02-02
        </span>

        
          <span class="post-category">
            &nbsp; | &nbsp; In
            
              <a href="/categories/scala/">scala</a>

              
              

            
          </span>
        

        
          
            <span class="post-comments-count">
            &nbsp; | &nbsp;
            <a href="/2015/02/02/《快学scala》习题解答-第十章-特质/#comments" >
              <span class="post-comments-count ds-thread-count" data-thread-key="2015/02/02/《快学scala》习题解答-第十章-特质/"></span>
            </a>
          </span>
          
        
      </div>
    </div>

    <div class="post-body">

      
      

      
        
          <pre><code>《快学Scala》（英文版：《Scala <span class="keyword">for</span> <span class="operator">the</span> Impatient》），代码已传github：
</code></pre><p><a href="https://github.com/vernonzheng/scala-for-the-Impatient" target="_blank" rel="external">https://github.com/vernonzheng/scala-for-the-Impatient</a></p>
<p>书为第一版。scala为2.11.4，jdk1.7.45，操作系统Mac OS X Yosemite 10.10.1。</p>
<h2 id="第十章_特质">第十章 特质</h2>
<p><strong>10.1</strong><br>java.awt.Rectangle类有两个很有用的方法translate和grow,但可惜的是像java.awt.geom.Ellipse2D这样的类没有。在Scala中，你可以解决掉这个问题。定义一个RenctangleLike特质,加入具体的translate和grow方法。提供任何你需要用来实现的抽象方法,以便你可以像如下代码这样混入该特质:<br>val egg = new java.awt.geom.Ellipse2D.Double(5,10,20,30) with RectangleLike<br>egg.translate(10,-10)<br>egg.grow(10,20)</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> java.awt.geom.Ellipse2D</div><div class="line"></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">trait</span> <span class="title">RectangleLike</span></span>{</div><div class="line">  <span class="keyword">this</span>:Ellipse2D.Double=&gt;</div><div class="line">  <span class="keyword">def</span> translate(x:Double,y:Double){</div><div class="line">    <span class="keyword">this</span>.x = x</div><div class="line">    <span class="keyword">this</span>.y = y</div><div class="line">  }</div><div class="line">  <span class="keyword">def</span> grow(x:Double,y:Double){</div><div class="line">    <span class="keyword">this</span>.x += x</div><div class="line">    <span class="keyword">this</span>.y += y</div><div class="line">  }</div><div class="line">}</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">object</span> <span class="title">Test</span> <span class="keyword">extends</span> <span class="title">App</span></span>{</div><div class="line">  <span class="keyword">val</span> egg = <span class="keyword">new</span> Ellipse2D.Double(<span class="number">5</span>,<span class="number">10</span>,<span class="number">20</span>,<span class="number">30</span>) <span class="keyword">with</span> RectangleLike</div><div class="line">  println(<span class="string">"x = "</span> + egg.getX + <span class="string">" y = "</span> + egg.getY)</div><div class="line">  egg.translate(<span class="number">10</span>,-<span class="number">10</span>)</div><div class="line">  println(<span class="string">"x = "</span> + egg.getX + <span class="string">" y = "</span> + egg.getY)</div><div class="line">  egg.grow(<span class="number">10</span>,<span class="number">20</span>)</div><div class="line">  println(<span class="string">"x = "</span> + egg.getX + <span class="string">" y = "</span> + egg.getY)</div><div class="line">}</div></pre></td></tr></table></figure>

<p><strong>10.2</strong><br>通过把scala.math.Ordered[Point]混入java.awt.Point的方式，定义OrderedPoint类。按辞典编辑方式排序，也就是说，如果x&lt;x’或者x=x’且y&lt;y’则(x,y)&lt;(x’,y’)</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> java.awt.Point</div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">OrderedPoint</span> <span class="keyword">extends</span> <span class="title">Point</span> <span class="keyword">with</span> <span class="title">Ordered</span>[<span class="title">Point</span>]</span>{</div><div class="line">  <span class="keyword">override</span> <span class="keyword">def</span> compare(that: Point): Int = {</div><div class="line">    <span class="keyword">if</span> (<span class="keyword">this</span>.x &lt;= that.x && <span class="keyword">this</span>.y &lt; that.y) -<span class="number">1</span></div><div class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">this</span>.x == that.x && <span class="keyword">this</span>.y == that.y) <span class="number">0</span></div><div class="line">    <span class="keyword">else</span> <span class="number">1</span></div><div class="line">  }</div><div class="line">}</div></pre></td></tr></table></figure>

<p><strong>10.3</strong><br>查看BitSet类,将它的所有超类和特质绘制成一张图。忽略类型参数([…]中的所有内容)。然后给出该特质的线性化规格说明 </p>
<p>略</p>
<p><strong>10.4</strong><br>提供一个CryptoLogger类，将日志消息以凯撒密码加密。缺省情况下密匙为3，不过使用者也可以重写它。提供缺省密匙和-3作为密匙是的使用示例 </p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">trait</span> <span class="title">Logger</span></span>{</div><div class="line">  <span class="keyword">def</span> log(str:String,key:Int = <span class="number">3</span>):String</div><div class="line">}</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">CryptoLogger</span> <span class="keyword">extends</span> <span class="title">Logger</span></span>{</div><div class="line"></div><div class="line">  <span class="keyword">def</span> log(str: String, key:Int): String = {</div><div class="line">    <span class="keyword">for</span> ( i &lt;- str) <span class="keyword">yield</span> <span class="keyword">if</span> (key &gt;= <span class="number">0</span>) (<span class="number">97</span> + ((i - <span class="number">97</span> + key)%<span class="number">26</span>)).toChar <span class="keyword">else</span> (<span class="number">97</span> + ((i - <span class="number">97</span> + <span class="number">26</span> + key)%<span class="number">26</span>)).toChar</div><div class="line">  }</div><div class="line">}</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">object</span> <span class="title">Test</span> <span class="keyword">extends</span> <span class="title">App</span></span>{</div><div class="line">    <span class="keyword">val</span> plain = <span class="string">"chenzhen"</span>;</div><div class="line">    println(<span class="string">"明文为："</span> + plain);</div><div class="line">    println(<span class="string">"加密后为："</span> + <span class="keyword">new</span> CryptoLogger().log(plain));</div><div class="line">    println(<span class="string">"加密后为："</span> + <span class="keyword">new</span> CryptoLogger().log(plain,-<span class="number">3</span>));</div><div class="line">}</div></pre></td></tr></table></figure>

<p><strong>10.5</strong><br>JavaBean规范里有一种提法叫做属性变更监听器(property change listener)，这是bean用来通知其属性变更的标准方式。PropertyChangeSupport类对于任何想要支持属性变更通知其属性变更监听器的bean而言是个便捷的超类。但可惜已有其他超类的类—比如JComponent—必须重新实现相应的方法。将PropertyChangeSupport重新实现为一个特质,然后将它混入到java.awt.Point类中 </p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> java.awt.Point</div><div class="line"><span class="keyword">import</span> java.beans.PropertyChangeSupport</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">trait</span> <span class="title">PropertyChange</span> <span class="keyword">extends</span> <span class="title">PropertyChangeSupport</span></span></div><div class="line"></div><div class="line"><span class="keyword">val</span> p = <span class="keyword">new</span> Point() <span class="keyword">with</span> PropertyChange</div></pre></td></tr></table></figure>

<p><strong>10.6</strong><br>在Java AWT类库中,我们有一个Container类，一个可以用于各种组件的Component子类。举例来说,Button是一个Component,但Panel是Container。这是一个运转中的组合模式。Swing有JComponent和JContainer,但如果你仔细看的话，你会发现一些奇怪的细节。尽管把其他组件添加到比如JButton中毫无意义,JComponent依然扩展自Container。Swing的设计者们理想情况下应该会更倾向于图10-4中的设计。但在Java中那是不可能的。请解释这是为什么？Scala中如何用特质来设计出这样的效果? </p>
<p>Java只能单继承。</p>
<p><strong>10.7</strong><br>市面上有不下数十种关于Scala特质的教程,用的都是些”在叫的狗”啦，”讲哲学的青蛙”啦之类的傻乎乎的例子。阅读和理解这些机巧的继承层级很乏味且对于理解问题没什么帮助,但自己设计一套继承层级就不同了,会很有启发。做一个你自己的关于特质的继承层级，要求体现出叠加在一起的特质,具体的和抽象的方法，以及具体的和抽象的字段 </p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">trait</span> <span class="title">Fly</span></span>{</div><div class="line">  <span class="keyword">def</span> fly(){</div><div class="line">    println(<span class="string">"flying"</span>)</div><div class="line">  }</div><div class="line"></div><div class="line">  <span class="keyword">def</span> flywithnowing()</div><div class="line">}</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">trait</span> <span class="title">Walk</span></span>{</div><div class="line">  <span class="keyword">def</span> walk(){</div><div class="line">    println(<span class="string">"walk"</span>)</div><div class="line">  }</div><div class="line">}</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Bird</span></span>{</div><div class="line">  <span class="keyword">var</span> name:String = _</div><div class="line">}</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">BlueBird</span> <span class="keyword">extends</span> <span class="title">Bird</span> <span class="keyword">with</span> <span class="title">Fly</span> <span class="keyword">with</span> <span class="title">Walk</span></span>{</div><div class="line">  <span class="keyword">def</span> flywithnowing() {</div><div class="line">    println(<span class="string">"BlueBird flywithnowing"</span>)</div><div class="line">  }</div><div class="line">}</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">object</span> <span class="title">Test</span> <span class="keyword">extends</span> <span class="title">App</span></span>{</div><div class="line">  <span class="keyword">val</span> b = <span class="keyword">new</span> BlueBird()</div><div class="line">  b.walk()</div><div class="line">  b.flywithnowing()</div><div class="line">  b.fly()</div><div class="line">}</div></pre></td></tr></table></figure>

<p><strong>10.8</strong><br>在java.io类库中，你可以通过BufferedInputStream修饰器来给输入流增加缓冲机制。用特质来重新实现缓冲。简单起见，重写read方法 </p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> java.io.{InputStream, FileInputStream}</div><div class="line"></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">trait</span> <span class="title">Buffering</span> </span>{</div><div class="line">	<span class="keyword">this</span>: InputStream =&gt;</div><div class="line"></div><div class="line">	<span class="keyword">val</span> BUF_SIZE: Int = <span class="number">5</span></div><div class="line">	<span class="keyword">private</span> <span class="keyword">val</span> buf = <span class="keyword">new</span> Array[Byte](BUF_SIZE)</div><div class="line">	<span class="keyword">private</span> <span class="keyword">var</span> bufsize: Int = <span class="number">0</span></div><div class="line">	<span class="keyword">private</span> <span class="keyword">var</span> pos: Int = <span class="number">0</span></div><div class="line"></div><div class="line">	<span class="keyword">override</span> <span class="keyword">def</span> read(): Int = {</div><div class="line">		<span class="keyword">if</span> (pos &gt;= bufsize) {</div><div class="line">			bufsize = <span class="keyword">this</span>.read(buf, <span class="number">0</span>, BUF_SIZE)</div><div class="line">			<span class="keyword">if</span> (bufsize &gt; <span class="number">0</span>) -<span class="number">1</span></div><div class="line">			pos = <span class="number">0</span></div><div class="line">		}</div><div class="line">		pos += <span class="number">1</span></div><div class="line">		buf(pos-<span class="number">1</span>)</div><div class="line">	}</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keyword">val</span> f = <span class="keyword">new</span> FileInputStream(<span class="string">"08.txt"</span>) <span class="keyword">with</span> Buffering</div><div class="line"></div><div class="line"><span class="keyword">for</span>(i &lt;- <span class="number">1</span> to <span class="number">10</span>) println(f.read())</div></pre></td></tr></table></figure>

<p><strong>10.9</strong><br>使用本章的日志生成器特质,给前一个练习中的方案增加日志功能，要求体现缓冲的效果</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> java.io.{InputStream, FileInputStream}</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">trait</span> <span class="title">Logger</span> </span>{</div><div class="line">  <span class="keyword">def</span> log(msg: String)</div><div class="line">}</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">trait</span> <span class="title">NoneLogger</span> <span class="keyword">extends</span> <span class="title">Logger</span> </span>{</div><div class="line">  <span class="keyword">def</span> log(msg: String) = {}</div><div class="line">}</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">trait</span> <span class="title">PrintLogger</span> <span class="keyword">extends</span> <span class="title">Logger</span> </span>{</div><div class="line">  <span class="keyword">def</span> log(msg: String) = println(msg)</div><div class="line">}</div><div class="line"></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">trait</span> <span class="title">Buffering</span> </span>{</div><div class="line">  <span class="keyword">this</span>: InputStream <span class="keyword">with</span> Logger =&gt;</div><div class="line"></div><div class="line">  <span class="keyword">val</span> BUF_SIZE: Int = <span class="number">5</span></div><div class="line">  <span class="keyword">private</span> <span class="keyword">val</span> buf = <span class="keyword">new</span> Array[Byte](BUF_SIZE)</div><div class="line">  <span class="keyword">private</span> <span class="keyword">var</span> bufsize: Int = <span class="number">0</span></div><div class="line">  <span class="keyword">private</span> <span class="keyword">var</span> pos: Int = <span class="number">0</span></div><div class="line"></div><div class="line">  <span class="keyword">override</span> <span class="keyword">def</span> read(): Int = {</div><div class="line">    <span class="keyword">if</span> (pos &gt;= bufsize) {</div><div class="line">      bufsize = <span class="keyword">this</span>.read(buf, <span class="number">0</span>, BUF_SIZE)</div><div class="line">      log(<span class="string">"buffered %d bytes: %s"</span>.format(bufsize, buf.mkString(<span class="string">", "</span>)))</div><div class="line">      <span class="keyword">if</span> (bufsize &gt; <span class="number">0</span>) -<span class="number">1</span></div><div class="line">      pos = <span class="number">0</span></div><div class="line">    }</div><div class="line">    pos += <span class="number">1</span></div><div class="line">    buf(pos-<span class="number">1</span>)</div><div class="line">  }</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keyword">val</span> f = <span class="keyword">new</span> FileInputStream(<span class="string">"exercise08.txt"</span>) <span class="keyword">with</span> Buffering <span class="keyword">with</span> PrintLogger</div><div class="line"></div><div class="line"><span class="keyword">for</span>(i &lt;- <span class="number">1</span> to <span class="number">10</span>) println(f.read())</div></pre></td></tr></table></figure>

<p><strong>10.10</strong><br>实现一个IterableInputStream类，扩展java.io.InputStream并混入Iterable[Byte]特质 </p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">IterableInputStream</span> <span class="keyword">extends</span> <span class="title">java</span>.<span class="title">io</span>.<span class="title">InputStream</span> <span class="keyword">with</span> <span class="title">Iterable</span>[<span class="title">Byte</span>]</span>{</div><div class="line">  <span class="class"><span class="keyword">class</span> <span class="title">InputStreamIterator</span><span class="params">(outer: IterableInputStream)</span> <span class="keyword">extends</span> <span class="title">Iterator</span>[<span class="title">Byte</span>] </span>{</div><div class="line">    <span class="keyword">def</span> hasNext: Boolean = outer.available() &gt; <span class="number">0</span></div><div class="line">    <span class="keyword">def</span> next: Byte = outer.read().toByte</div><div class="line">  }</div><div class="line"></div><div class="line">  <span class="keyword">override</span> <span class="keyword">def</span> iterator: Iterator[Byte] = <span class="keyword">new</span> InputStreamIterator(<span class="keyword">this</span>)</div><div class="line">  <span class="keyword">override</span> <span class="keyword">def</span> read(): Int = <span class="number">0</span></div><div class="line"></div><div class="line">}</div></pre></td></tr></table></figure>

<hr>
<p>参考：<br>《快学Scala》：<a href="http://book.douban.com/subject/19971952/" target="_blank" rel="external">http://book.douban.com/subject/19971952/</a></p>
<p><strong>（转载本站文章请注明作者和出处 Vernon Zheng(郑雪峰) – vernonzheng.com ，请勿用于任何商业用途）</strong></p>

        
      
    </div>

    <div class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </div>
  </div>


    
      

  <div class="post post-type-normal ">
    <div class="post-header">

      
      
        <h1 class="post-title">
          
          
            
              <a class="post-title-link" href="/2015/02/01/《快学scala》习题解答-第九章-文件和正则表达式/">
                《快学scala》习题解答-第九章-文件和正则表达式
              </a>
            
          
        </h1>
      

      <div class="post-meta">
        <span class="post-time">
          Posted on 2015-02-01
        </span>

        
          <span class="post-category">
            &nbsp; | &nbsp; In
            
              <a href="/categories/scala/">scala</a>

              
              

            
          </span>
        

        
          
            <span class="post-comments-count">
            &nbsp; | &nbsp;
            <a href="/2015/02/01/《快学scala》习题解答-第九章-文件和正则表达式/#comments" >
              <span class="post-comments-count ds-thread-count" data-thread-key="2015/02/01/《快学scala》习题解答-第九章-文件和正则表达式/"></span>
            </a>
          </span>
          
        
      </div>
    </div>

    <div class="post-body">

      
      

      
        
          <pre><code>《快学Scala》（英文版：《Scala <span class="keyword">for</span> <span class="operator">the</span> Impatient》），代码已传github：
</code></pre><p><a href="https://github.com/vernonzheng/scala-for-the-Impatient" target="_blank" rel="external">https://github.com/vernonzheng/scala-for-the-Impatient</a></p>
<p>书为第一版。scala为2.11.4，jdk1.7.45，操作系统Mac OS X Yosemite 10.10.1。</p>
<h2 id="第九章_文件和正则表达式">第九章 文件和正则表达式</h2>
<p><strong>9.1</strong><br>编写一小段Scala代码，将某个文件中的行倒转顺序(将最后一行作为第一行,依此类推)</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">val</span> path = <span class="string">"./exercise01.txt"</span></div><div class="line"><span class="keyword">val</span> file = Source.fromFile(path)</div><div class="line"><span class="keyword">val</span> reverseLines = file.getLines().toArray.reverse</div><div class="line"><span class="keyword">val</span> pw = <span class="keyword">new</span> PrintWriter(path)</div><div class="line">reverseLines.foreach (line =&gt; pw.write(line+<span class="string">"\n"</span>))</div><div class="line">pw.close()</div></pre></td></tr></table></figure>

<p><strong>9.2</strong><br>编写Scala程序,从一个带有制表符的文件读取内容,将每个制表符替换成一组空格,使得制表符隔开的n列仍然保持纵向对齐,并将结果写入同一个文件</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> io.Source</div><div class="line"><span class="keyword">import</span> java.io.PrintWriter</div><div class="line"></div><div class="line"><span class="keyword">val</span> path = <span class="string">"test.txt"</span></div><div class="line"></div><div class="line"><span class="keyword">val</span> reader = Source.fromFile(path).getLines()</div><div class="line"></div><div class="line"><span class="keyword">val</span> result = <span class="keyword">for</span> ( t &lt;- reader) <span class="keyword">yield</span> t.replaceAll(<span class="string">"\\t"</span>,<span class="string">"    "</span>)</div><div class="line"></div><div class="line"><span class="keyword">val</span> pw = <span class="keyword">new</span> PrintWriter(path)</div><div class="line"></div><div class="line">result.foreach(line =&gt; pw.write(line + <span class="string">"\n"</span>))</div><div class="line"></div><div class="line">pw.close()</div></pre></td></tr></table></figure>

<p><strong>9.3</strong><br>编写一小段Scala代码,从一个文件读取内容并把所有字符数大于12的单词打印到控制台。如果你能用单行代码完成会有额外奖励</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">scala.io.Source.fromFile(<span class="string">"./exercise01.txt"</span>).mkString.split(<span class="string">"\\s+"</span>).foreach(line=&gt; <span class="keyword">if</span>(line.length&gt;<span class="number">12</span>) println(line))</div></pre></td></tr></table></figure>

<p><strong>9.4</strong><br>编写Scala程序，从包含浮点数的文本文件读取内容，打印出文件中所有浮点数之和，平均值，最大值和最小值</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> scala.io.Source</div><div class="line"><span class="keyword">val</span> nums = Source.fromFile(<span class="string">"exercise01.txt"</span>).mkString.split(<span class="string">"\\s+"</span>)</div><div class="line"></div><div class="line"><span class="keyword">var</span> total = <span class="number">0</span>d</div><div class="line"></div><div class="line">nums.foreach(total += _.toDouble)</div><div class="line"></div><div class="line">println(total)</div><div class="line">println(total/nums.length)</div><div class="line">println(nums.max)</div><div class="line">println(nums.min)</div></pre></td></tr></table></figure>

<p><strong>9.5</strong><br>编写Scala程序，向文件中写入2的n次方及其倒数，指数n从0到20。对齐各列:<br>  1         1<br>  2         0.5<br>  4         0.25<br>…         …</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> java.io.PrintWriter</div><div class="line"></div><div class="line"><span class="keyword">val</span> pw = <span class="keyword">new</span> PrintWriter(<span class="string">"exercise01.txt"</span>)</div><div class="line"></div><div class="line"><span class="keyword">for</span> ( n &lt;- <span class="number">0</span> to <span class="number">20</span>){</div><div class="line">  <span class="keyword">val</span> t = BigDecimal(<span class="number">2</span>).pow(n)</div><div class="line">  pw.write(t.toString())</div><div class="line">  pw.write(<span class="string">"\t\t"</span>)</div><div class="line">  pw.write((<span class="number">1</span>/t).toString())</div><div class="line">  pw.write(<span class="string">"\n"</span>)</div><div class="line">}</div><div class="line"></div><div class="line">pw.close()</div></pre></td></tr></table></figure>

<p><strong>9.6</strong><br>编写正则表达式,匹配Java或C++程序代码中类似”like this,maybe with \” or\“这样的带引号的字符串。编写Scala程序将某个源文件中所有类似的字符串打印出来</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">val source = scala.io.Source.fromFile("test.txt").mkString</div><div class="line"></div><div class="line">val pattern = """"([^"\\]*([\\]+"[^"\\]*)*)"""".r</div><div class="line"></div><div class="line">pattern.findAllIn(source).foreach(println)</div></pre></td></tr></table></figure>

<p><strong>9.7</strong><br>编写Scala程序，从文本文件读取内容，并打印出所有的非浮点数的词法单位。要求使用正则表达式</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> io.Source</div><div class="line"></div><div class="line"><span class="keyword">val</span> source = Source.fromFile(<span class="string">"test.txt"</span>).mkString</div><div class="line"></div><div class="line"><span class="keyword">val</span> pattern = <span class="string">"""[^((\d+\.){0,1}\d+)^\s+]+"""</span>.r</div><div class="line"></div><div class="line">pattern.findAllIn(source).foreach(println)</div></pre></td></tr></table></figure>

<p><strong>9.8</strong><br>编写Scala程序打印出某个网页中所有img标签的src属性。使用正则表达式和分组</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">val</span> pattern = <span class="string">"""&lt;img[^&gt;]+(src\s*=\s*"[^&gt;^"]+")[^&gt;]*&gt;"""</span>.r</div><div class="line"><span class="keyword">val</span> source = scala.io.Source.fromURL(<span class="string">"http://www.vernonzheng.com"</span>,<span class="string">"utf-8"</span>).mkString</div><div class="line"></div><div class="line"><span class="keyword">for</span> (pattern(str) &lt;- pattern.findAllIn(source)) println(str)</div></pre></td></tr></table></figure>

<p><strong>9.9</strong><br>编写Scala程序，盘点给定目录及其子目录中总共有多少以.class为扩展名的文件</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">def</span> countClass(dir:java.io.File): Int = {</div><div class="line">  <span class="keyword">var</span> num:Int = <span class="number">0</span></div><div class="line">  <span class="keyword">val</span> files = dir.listFiles()</div><div class="line">  num += files.filter(_.isFile).count(_.getName.endsWith(<span class="string">".class"</span>))</div><div class="line">  files.filter(_.isDirectory).foreach(num += countClass(_))</div><div class="line">  num</div><div class="line">}</div></pre></td></tr></table></figure>

<p><strong>9.10</strong><br>扩展那个可序列化的Person类，让它能以一个集合保存某个人的朋友信息。构造出一些Person对象，让他们中的一些人成为朋友，然后将Array[Person]保存到文件。将这个数组从文件中重新读出来，校验朋友关系是否完好</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div></pre></td><td class="code"><pre><div class="line">mport collection.mutable.ArrayBuffer</div><div class="line"><span class="keyword">import</span> java.io.{ObjectInputStream, FileOutputStream, FileInputStream, ObjectOutputStream}</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span><span class="params">(var name:String)</span> <span class="keyword">extends</span> <span class="title">Serializable</span></span>{</div><div class="line"></div><div class="line">  <span class="keyword">val</span> friends = <span class="keyword">new</span> ArrayBuffer[Person]()</div><div class="line"></div><div class="line">  <span class="keyword">def</span> addFriend(friend : Person){</div><div class="line">    friends += friend</div><div class="line">  }</div><div class="line"></div><div class="line">  <span class="keyword">override</span> <span class="keyword">def</span> toString() = {</div><div class="line">    <span class="keyword">var</span> str = <span class="string">"My name is "</span> + name + <span class="string">" and my friends name is "</span></div><div class="line">    friends.foreach(str += _.name + <span class="string">","</span>)</div><div class="line">    str</div><div class="line">  }</div><div class="line">}</div><div class="line"></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">object</span> <span class="title">Test</span> <span class="keyword">extends</span> <span class="title">App</span></span>{</div><div class="line">  <span class="keyword">val</span> p1 = <span class="keyword">new</span> Person(<span class="string">"Ivan"</span>)</div><div class="line">  <span class="keyword">val</span> p2 = <span class="keyword">new</span> Person(<span class="string">"F2"</span>)</div><div class="line">  <span class="keyword">val</span> p3 = <span class="keyword">new</span> Person(<span class="string">"F3"</span>)</div><div class="line"></div><div class="line">  p1.addFriend(p2)</div><div class="line">  p1.addFriend(p3)</div><div class="line">  println(p1)</div><div class="line"></div><div class="line">  <span class="keyword">val</span> out = <span class="keyword">new</span> ObjectOutputStream(<span class="keyword">new</span> FileOutputStream(<span class="string">"person.obj"</span>))</div><div class="line">  out.writeObject(p1)</div><div class="line">  out.close()</div><div class="line"></div><div class="line">  <span class="keyword">val</span> in =  <span class="keyword">new</span> ObjectInputStream(<span class="keyword">new</span> FileInputStream(<span class="string">"person.obj"</span>))</div><div class="line">  <span class="keyword">val</span> p = in.readObject().asInstanceOf[Person]</div><div class="line">  println(p)</div><div class="line">}</div></pre></td></tr></table></figure>

<hr>
<p>参考：<br>《快学Scala》：<a href="http://book.douban.com/subject/19971952/" target="_blank" rel="external">http://book.douban.com/subject/19971952/</a></p>
<p><strong>（转载本站文章请注明作者和出处 Vernon Zheng(郑雪峰) – vernonzheng.com ，请勿用于任何商业用途）</strong></p>

        
      
    </div>

    <div class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </div>
  </div>


    
      

  <div class="post post-type-normal ">
    <div class="post-header">

      
      
        <h1 class="post-title">
          
          
            
              <a class="post-title-link" href="/2015/02/01/《快学scala》习题解答-第八章-继承/">
                《快学scala》习题解答-第八章-继承
              </a>
            
          
        </h1>
      

      <div class="post-meta">
        <span class="post-time">
          Posted on 2015-02-01
        </span>

        
          <span class="post-category">
            &nbsp; | &nbsp; In
            
              <a href="/categories/scala/">scala</a>

              
              

            
          </span>
        

        
          
            <span class="post-comments-count">
            &nbsp; | &nbsp;
            <a href="/2015/02/01/《快学scala》习题解答-第八章-继承/#comments" >
              <span class="post-comments-count ds-thread-count" data-thread-key="2015/02/01/《快学scala》习题解答-第八章-继承/"></span>
            </a>
          </span>
          
        
      </div>
    </div>

    <div class="post-body">

      
      

      
        
          <pre><code>《快学Scala》（英文版：《Scala <span class="keyword">for</span> <span class="operator">the</span> Impatient》），代码已传github：
</code></pre><p><a href="https://github.com/vernonzheng/scala-for-the-Impatient" target="_blank" rel="external">https://github.com/vernonzheng/scala-for-the-Impatient</a></p>
<p>书为第一版。scala为2.11.4，jdk1.7.45，操作系统Mac OS X Yosemite 10.10.1。</p>
<h2 id="第八章_继承">第八章 继承</h2>
<p><strong>8.1</strong><br>扩展如下的BankAccount类，新类CheckingAccount对每次存款和取款都收取1美元的手续费<br>class BankAccount(initialBalance:Double){<br>    private var balance = initialBalance<br>    def deposit(amount:Double) = { balance += amount; balance}<br>    def withdraw(amount:Double) = {balance -= amount; balance}<br>}</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">BankAccount</span><span class="params">(initialBalance:Double)</span></span>{</div><div class="line">  <span class="keyword">private</span> <span class="keyword">var</span> balance = initialBalance</div><div class="line">  <span class="keyword">def</span> deposit(amount:Double) = { balance += amount; balance}</div><div class="line">  <span class="keyword">def</span> withdraw(amount:Double) = {balance -= amount; balance}</div><div class="line">}</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">CheckingAccount</span><span class="params">(initialBanlance:Double)</span> <span class="keyword">extends</span> <span class="title">BankAccount</span><span class="params">(initialBanlance)</span></span>{</div><div class="line">  <span class="keyword">override</span> <span class="keyword">def</span> deposit(amount:Double) = <span class="keyword">super</span>.deposit(amount-<span class="number">1</span>)</div><div class="line">  <span class="keyword">override</span> <span class="keyword">def</span> withdraw(amount:Double) = <span class="keyword">super</span>.withdraw(amount+<span class="number">1</span>)</div><div class="line">}</div></pre></td></tr></table></figure>

<p><strong>8.2</strong><br>扩展前一个练习的BankAccount类，新类SavingsAccount每个月都有利息产生(earnMonthlyInterest方法被调用)，并且有每月三次免手续费的存款或取款。在earnMonthlyInterest方法中重置交易计数。</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">BankAccount</span><span class="params">(initialBalance:Double)</span></span>{</div><div class="line">  <span class="keyword">private</span> <span class="keyword">var</span> balance = initialBalance</div><div class="line">  <span class="keyword">def</span> deposit(amount:Double) = { balance += amount; balance}</div><div class="line">  <span class="keyword">def</span> withdraw(amount:Double) = {balance -= amount; balance}</div><div class="line">}</div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">SavingsAccount</span><span class="params">(initialBalance:Double)</span> <span class="keyword">extends</span> <span class="title">BankAccount</span><span class="params">(initialBalance)</span></span>{</div><div class="line">  <span class="keyword">private</span> <span class="keyword">var</span> num:Int = _</div><div class="line">  <span class="keyword">def</span> earnMonthlyInterest()={</div><div class="line">    num = <span class="number">3</span></div><div class="line">    <span class="keyword">super</span>.deposit(<span class="number">1</span>)</div><div class="line">  }</div><div class="line"></div><div class="line">  <span class="keyword">override</span> <span class="keyword">def</span> deposit(amount: Double): Double = {</div><div class="line">    num -= <span class="number">1</span></div><div class="line">    <span class="keyword">if</span>(num &lt; <span class="number">0</span>) <span class="keyword">super</span>.deposit(amount - <span class="number">1</span>) <span class="keyword">else</span> <span class="keyword">super</span>.deposit(amount)</div><div class="line">  }</div><div class="line"></div><div class="line">  <span class="keyword">override</span> <span class="keyword">def</span> withdraw(amount: Double): Double = {</div><div class="line">    num -= <span class="number">1</span></div><div class="line">    <span class="keyword">if</span> (num &lt; <span class="number">0</span>) <span class="keyword">super</span>.withdraw(amount + <span class="number">1</span>) <span class="keyword">else</span> <span class="keyword">super</span>.withdraw(amount)</div><div class="line">  }</div><div class="line">}</div></pre></td></tr></table></figure>

<p><strong>8.3</strong><br>翻开你喜欢的Java或C++教科书，一定会找到用来讲解继承层级的实例，可能是员工，宠物，图形或类似的东西。用Scala来实现这个示例。</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line"><span class="javadoc">/**</span></div><div class="line"> * java</div><div class="line"> * class Art{</div><div class="line">    Art(){System.out.println("Art constructor");}</div><div class="line">  }</div><div class="line"></div><div class="line">  class Drawing extends Art{</div><div class="line">    Drawing() {System.out.println("Drawing constructor");}</div><div class="line">  }</div><div class="line"></div><div class="line">  public class Cartoon extends Drawing{</div><div class="line">    public Cartoon() { System.out.println("Cartoon constructor");}</div><div class="line">  }</div><div class="line"> */</div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Art</span></span>{</div><div class="line">  println(<span class="string">"Art constructor"</span>)</div><div class="line">}</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Drawing</span> <span class="keyword">extends</span> <span class="title">Art</span></span>{</div><div class="line">  println(<span class="string">"Drawing constructor"</span>)</div><div class="line">}</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Cartoon</span> <span class="keyword">extends</span> <span class="title">Drawing</span></span>{</div><div class="line">  println(<span class="string">"Cartoon constructor"</span>)</div><div class="line">}</div></pre></td></tr></table></figure>

<p><strong>8.4</strong><br>定义一个抽象类Item,加入方法price和description。SimpleItem是一个在构造器中给出价格和描述的物件。利用val可以重写def这个事实。Bundle是一个可以包含其他物件的物件。其价格是打包中所有物件的价格之和。同时提供一个将物件添加到打包当中的机制，以及一个适合的description方法</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> collection.mutable.ArrayBuffer</div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Item</span></span>{</div><div class="line">  <span class="keyword">def</span> price():Double</div><div class="line">  <span class="keyword">def</span> description():String</div><div class="line"></div><div class="line">  <span class="keyword">override</span> <span class="keyword">def</span> toString():String={</div><div class="line">    <span class="string">"description:"</span> + description() + <span class="string">"  price:"</span> + price()</div><div class="line">  }</div><div class="line">}</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">SimpleItem</span><span class="params">(val price:Double,val description:String)</span> <span class="keyword">extends</span> <span class="title">Item</span></span>{</div><div class="line"></div><div class="line">}</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Bundle</span> <span class="keyword">extends</span> <span class="title">Item</span></span>{</div><div class="line"></div><div class="line">  <span class="keyword">val</span> items = <span class="keyword">new</span> ArrayBuffer[Item]()</div><div class="line"></div><div class="line">  <span class="keyword">def</span> addItem(item:Item){</div><div class="line">    items += item</div><div class="line">  }</div><div class="line"></div><div class="line">  <span class="keyword">def</span> price(): Double = {</div><div class="line">    <span class="keyword">var</span> total = <span class="number">0</span>d</div><div class="line">    items.foreach(total += _.price())</div><div class="line">    total</div><div class="line">  }</div><div class="line"></div><div class="line">  <span class="keyword">def</span> description(): String = {</div><div class="line">    items.mkString(<span class="string">" "</span>)</div><div class="line">  }</div><div class="line">}</div></pre></td></tr></table></figure>

<p><strong>8.5</strong><br>设计一个Point类，其x和y坐标可以通过构造器提供。提供一个子类LabeledPoint，其构造器接受一个标签值和x,y坐标,比如:new LabeledPoint(“Black Thursday”,1929,230.07)</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Point</span><span class="params">(x:Double, y:Double)</span></span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">LabeledPoint</span><span class="params">(x:Double, y:Double, tag:String)</span> <span class="keyword">extends</span> <span class="title">Point</span><span class="params">(x,y)</span></span></div></pre></td></tr></table></figure>

<p><strong>8.6</strong><br>定义一个抽象类Shape，一个抽象方法centerPoint，以及该抽象类的子类Rectangle和Circle。为子类提供合适的构造器，并重写centerPoint方法</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Shape</span></span>{</div><div class="line">  <span class="keyword">def</span> centerPoint()</div><div class="line">}</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Rectangle</span><span class="params">(startX:Int,startY:Int,endX:Int,endY:Int)</span> <span class="keyword">extends</span> <span class="title">Shape</span></span>{</div><div class="line">  <span class="keyword">def</span> centerPoint() {}</div><div class="line">}</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Circle</span><span class="params">(x:Int,y:Int,radius:Double)</span> <span class="keyword">extends</span> <span class="title">Shape</span></span>{</div><div class="line">  <span class="keyword">def</span> centerPoint() {}</div><div class="line">}</div></pre></td></tr></table></figure>

<p><strong>8.7</strong><br>提供一个Square类，扩展自java.awt.Rectangle并且是三个构造器：一个以给定的端点和宽度构造正方形，一个以(0,0)为端点和给定的宽度构造正方形，一个以(0,0)为端点,0为宽度构造正方形</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> java.awt.{Point, Rectangle}</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Square</span><span class="params">(point:Point,width:Int)</span> <span class="keyword">extends</span> <span class="title">Rectangle</span><span class="params">(point.x,point.y,width,width)</span></span>{</div><div class="line"></div><div class="line">  <span class="keyword">def</span> <span class="keyword">this</span>(){</div><div class="line">    <span class="keyword">this</span>(<span class="keyword">new</span> Point(<span class="number">0</span>,<span class="number">0</span>),<span class="number">0</span>)</div><div class="line">  }</div><div class="line"></div><div class="line">  <span class="keyword">def</span> <span class="keyword">this</span>(width:Int){</div><div class="line">    <span class="keyword">this</span>(<span class="keyword">new</span> Point(<span class="number">0</span>,<span class="number">0</span>),width)</div><div class="line">  }</div><div class="line">}</div></pre></td></tr></table></figure>

<p><strong>8.8</strong><br>编译8.6节中的Person和SecretAgent类并使用javap分析类文件。总共有多少name的getter方法？它们分别取什么值？(提示：可以使用-c和-private选项)</p>
<p>总共两个。Person中取得的是传入的name,而SecretAgent中取得的是默认的”secret”</p>
<p><strong>8.9</strong><br>在8.10节的Creature类中，将val range替换成一个def。如果你在Ant子类中也用def的话会有什么效果？如果在子类中使用val又会有什么效果？为什么？</p>
<p>在Ant中使用def没有问题。但是如果使用val则无法编译。因为val只能重写不带参数的def。这里的def是带参数的</p>
<p><strong>8.10</strong><br>文件scala/collection/immutable/Stack.scala包含如下定义:<br>class Stack[A] protected (protected val elems: List[A])<br>请解释protected关键字的含义。(提示：回顾我们在第5章中关于私有构造器的讨论) 此构造方法只能被其子类来调用,而不能被外界直接调用</p>
<p>此构造方法只能被其子类来调用,而不能被外界直接调用</p>
<hr>
<p>参考：<br>《快学Scala》：<a href="http://book.douban.com/subject/19971952/" target="_blank" rel="external">http://book.douban.com/subject/19971952/</a></p>
<p><strong>（转载本站文章请注明作者和出处 Vernon Zheng(郑雪峰) – vernonzheng.com ，请勿用于任何商业用途）</strong></p>

        
      
    </div>

    <div class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </div>
  </div>


    
      

  <div class="post post-type-normal ">
    <div class="post-header">

      
      
        <h1 class="post-title">
          
          
            
              <a class="post-title-link" href="/2015/01/31/《快学scala》习题解答-第七章-包和引入/">
                《快学scala》习题解答-第七章-包和引入
              </a>
            
          
        </h1>
      

      <div class="post-meta">
        <span class="post-time">
          Posted on 2015-01-31
        </span>

        
          <span class="post-category">
            &nbsp; | &nbsp; In
            
              <a href="/categories/scala/">scala</a>

              
              

            
          </span>
        

        
          
            <span class="post-comments-count">
            &nbsp; | &nbsp;
            <a href="/2015/01/31/《快学scala》习题解答-第七章-包和引入/#comments" >
              <span class="post-comments-count ds-thread-count" data-thread-key="2015/01/31/《快学scala》习题解答-第七章-包和引入/"></span>
            </a>
          </span>
          
        
      </div>
    </div>

    <div class="post-body">

      
      

      
        
          <pre><code>《快学Scala》（英文版：《Scala <span class="keyword">for</span> <span class="operator">the</span> Impatient》），代码已传github：
</code></pre><p><a href="https://github.com/vernonzheng/scala-for-the-Impatient" target="_blank" rel="external">https://github.com/vernonzheng/scala-for-the-Impatient</a></p>
<p>书为第一版。scala为2.11.4，jdk1.7.45，操作系统Mac OS X Yosemite 10.10.1。</p>
<h2 id="第七章_包和引用">第七章 包和引用</h2>
<p><strong>7.1</strong><br>编写示例程序，展示为什么<br>package com.horstmann.impatient<br>不同于<br>package com<br>package horstmann<br>package impatient </p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> com {</div><div class="line">  <span class="class"><span class="keyword">class</span> <span class="title">T1</span><span class="params">()</span> </span>{}</div><div class="line"></div><div class="line">  <span class="keyword">package</span> horstmann {</div><div class="line">    <span class="class"><span class="keyword">class</span> <span class="title">T2</span><span class="params">(t: T1)</span> </span>{}</div><div class="line"></div><div class="line">    <span class="keyword">package</span> impatient {</div><div class="line">      <span class="class"><span class="keyword">class</span> <span class="title">T3</span><span class="params">(t1: T1, t2: T2)</span> </span>{}</div><div class="line">    }</div><div class="line">  }</div><div class="line">}</div><div class="line"><span class="keyword">package</span> com.horstmann.impatient{</div><div class="line">  <span class="comment">//class T4(t1:T1,t3:T3)      //can not find type T1</span></div><div class="line">}</div></pre></td></tr></table></figure>

<p><strong>7.2</strong><br>编写一段让你的Scala朋友们感到困惑的代码，使用一个不在顶部的com包</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> vernon {</div><div class="line">  <span class="class"><span class="keyword">class</span> <span class="title">T1</span><span class="params">()</span> </span>{}</div><div class="line"></div><div class="line">  <span class="keyword">package</span> com {</div><div class="line">    <span class="class"><span class="keyword">class</span> <span class="title">T2</span><span class="params">(t: T1)</span> </span>{}</div><div class="line">  }</div><div class="line">  </div><div class="line"></div><div class="line">  <span class="keyword">package</span> impatient {</div><div class="line">    <span class="class"><span class="keyword">class</span> <span class="title">T3</span><span class="params">(t1: T1, t2: com.T2)</span> </span>{}</div><div class="line">  }</div><div class="line">}</div></pre></td></tr></table></figure>

<p><strong>7.3</strong><br>编写一个包random,加入函数nextInt():Int,nextDouble():Double,setSeed(seed:Int):Unit。生成随机数的算法采用线性同余生成器</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> <span class="class"><span class="keyword">object</span> <span class="title">random</span></span>{</div><div class="line"></div><div class="line">  <span class="keyword">var</span> seed:Int = _</div><div class="line">  <span class="keyword">val</span> a = BigDecimal(<span class="number">1664525</span>)</div><div class="line">  <span class="keyword">val</span> b = BigDecimal(<span class="number">1013904223</span>)</div><div class="line">  <span class="keyword">val</span> n = <span class="number">32</span></div><div class="line"></div><div class="line">  <span class="keyword">def</span> nextInt():Int={</div><div class="line">    <span class="keyword">val</span> temp = (seed * a + b) % BigDecimal(<span class="number">2</span>).pow(n)</div><div class="line">    seed = temp.toInt</div><div class="line">    seed</div><div class="line">  }</div><div class="line"></div><div class="line">  <span class="keyword">def</span> nextDouble():Double={</div><div class="line">    <span class="keyword">val</span> temp = (seed * a + b) % BigDecimal(<span class="number">2</span>).pow(n)</div><div class="line">    seed = temp.toInt</div><div class="line">    temp.toDouble</div><div class="line">  }</div><div class="line">}</div><div class="line"><span class="keyword">import</span> random._</div><div class="line"><span class="class"><span class="keyword">object</span> <span class="title">Q3</span> <span class="keyword">extends</span> <span class="title">App</span> </span>{</div><div class="line">  (<span class="number">1</span> to <span class="number">10</span>).foreach(x =&gt; println(nextInt()))</div><div class="line">  (<span class="number">1</span> to <span class="number">10</span>).foreach(x =&gt; println(nextDouble()))</div><div class="line">}</div></pre></td></tr></table></figure>

<p><strong>7.4</strong><br>在你看来Scala的设计者为什么要提供package object语法而不是简单的让你将函数和变量添加到包中呢？</p>
<p>JVM不支持</p>
<p><strong>7.5</strong><br>private[com] def giveRaise(rate:Double)的含义是什么？有用吗？</p>
<p>除了com包可访问giveRaise，其他包都不能访问。有用。</p>
<p><strong>7.6</strong><br>编写一段程序,将Java哈希映射中的所有元素拷贝到Scala哈希映射。用引入语句重命名这两个类。</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">object</span> <span class="title">Q6</span> <span class="keyword">extends</span> <span class="title">App</span></span>{</div><div class="line"></div><div class="line">  <span class="keyword">import</span> java.util.{HashMap =&gt; JavaHashMap}</div><div class="line">  <span class="keyword">import</span> collection.mutable.{HashMap =&gt; ScalaHashMap, Map =&gt; ScalaMap}</div><div class="line"></div><div class="line">  <span class="keyword">val</span> javaMap = <span class="keyword">new</span> JavaHashMap[Int,String]</div><div class="line"></div><div class="line">  javaMap.put(<span class="number">1</span>, <span class="string">"One"</span>);</div><div class="line">  javaMap.put(<span class="number">2</span>, <span class="string">"Two"</span>);</div><div class="line">  javaMap.put(<span class="number">3</span>, <span class="string">"Three"</span>);</div><div class="line">  javaMap.put(<span class="number">4</span>, <span class="string">"Four"</span>);</div><div class="line"></div><div class="line">  <span class="keyword">val</span> scalaMap = <span class="keyword">new</span> ScalaHashMap[Int,String]</div><div class="line"></div><div class="line">  <span class="keyword">for</span>(key &lt;- javaMap.keySet().toArray){</div><div class="line">    scalaMap += (key.asInstanceOf[Int] -&gt; javaMap.get(key))</div><div class="line">  }</div><div class="line"></div><div class="line">  println(scalaMap.mkString(<span class="string">" "</span>))</div><div class="line">}</div></pre></td></tr></table></figure>

<p><strong>7.7</strong><br>在前一个练习中，将所有引入语句移动到尽可能小的作用域里</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">object</span> <span class="title">Q7</span> <span class="keyword">extends</span> <span class="title">App</span></span>{</div><div class="line"></div><div class="line">  <span class="keyword">import</span> java.util.{HashMap =&gt; JavaHashMap}</div><div class="line">  </div><div class="line">  <span class="keyword">val</span> javaMap = <span class="keyword">new</span> JavaHashMap[Int,String]</div><div class="line"></div><div class="line">  javaMap.put(<span class="number">1</span>, <span class="string">"One"</span>);</div><div class="line">  javaMap.put(<span class="number">2</span>, <span class="string">"Two"</span>);</div><div class="line">  javaMap.put(<span class="number">3</span>, <span class="string">"Three"</span>);</div><div class="line">  javaMap.put(<span class="number">4</span>, <span class="string">"Four"</span>);</div><div class="line">  </div><div class="line">  <span class="keyword">import</span> collection.mutable.{HashMap =&gt; ScalaHashMap, Map =&gt; ScalaMap}</div><div class="line">  </div><div class="line">  <span class="keyword">val</span> scalaMap = <span class="keyword">new</span> ScalaHashMap[Int,String]</div><div class="line"></div><div class="line">  <span class="keyword">for</span>(key &lt;- javaMap.keySet().toArray()){</div><div class="line">    scalaMap += (key.asInstanceOf[Int] -&gt; javaMap.get(key))</div><div class="line">  }</div><div class="line"></div><div class="line">  println(scalaMap.mkString(<span class="string">" "</span>))</div><div class="line">}</div></pre></td></tr></table></figure>

<p><strong>7.8</strong><br>以下代码的作用是什么？这是个好主意吗？<br>import java.<em><br>import javax.</em></p>
<p>导入java和javax下的所有类。而java和javax下是没有类的。所以此代码无用</p>
<p><strong>7.9</strong><br>编写一段程序，引入java.lang.System类，从user.name系统属性读取用户名，从Console对象读取一个密码,如果密码不是”secret”，则在标准错误流中打印一个消息；如果密码是”secret”，则在标准输出流中打印一个问候消息。不要使用任何其他引入，也不要使用任何限定词(带句点的那种)</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">object</span> <span class="title">Q9</span> <span class="keyword">extends</span> <span class="title">App</span></span>{</div><div class="line">  <span class="keyword">import</span> java.lang.System._</div><div class="line">  <span class="keyword">var</span> password = Console.readLine()</div><div class="line"></div><div class="line">  <span class="keyword">if</span> (password equals <span class="string">"secret"</span>)</div><div class="line">    System.out.println(<span class="string">"Hello "</span> + getProperty(<span class="string">"user.name"</span>))</div><div class="line">  <span class="keyword">else</span></div><div class="line">    System.err.println(<span class="string">"password error!"</span>)</div><div class="line">}</div></pre></td></tr></table></figure>

<p><strong>7.10</strong><br>除了StringBuilder,还有哪些java.lang的成员是被scala包覆盖的？</p>
<p>比对java.lang下的类和scala包下的类，略</p>
<hr>
<p>参考：<br>《快学Scala》：<a href="http://book.douban.com/subject/19971952/" target="_blank" rel="external">http://book.douban.com/subject/19971952/</a></p>
<p><strong>（转载本站文章请注明作者和出处 Vernon Zheng(郑雪峰) – vernonzheng.com ，请勿用于任何商业用途）</strong></p>

        
      
    </div>

    <div class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </div>
  </div>


    
      

  <div class="post post-type-normal ">
    <div class="post-header">

      
      
        <h1 class="post-title">
          
          
            
              <a class="post-title-link" href="/2015/01/31/《快学scala》习题解答-第六章-对象/">
                《快学scala》习题解答-第六章-对象
              </a>
            
          
        </h1>
      

      <div class="post-meta">
        <span class="post-time">
          Posted on 2015-01-31
        </span>

        
          <span class="post-category">
            &nbsp; | &nbsp; In
            
              <a href="/categories/scala/">scala</a>

              
              

            
          </span>
        

        
          
            <span class="post-comments-count">
            &nbsp; | &nbsp;
            <a href="/2015/01/31/《快学scala》习题解答-第六章-对象/#comments" >
              <span class="post-comments-count ds-thread-count" data-thread-key="2015/01/31/《快学scala》习题解答-第六章-对象/"></span>
            </a>
          </span>
          
        
      </div>
    </div>

    <div class="post-body">

      
      

      
        
          <pre><code>《快学Scala》（英文版：《Scala <span class="keyword">for</span> <span class="operator">the</span> Impatient》），代码已传github：
</code></pre><p><a href="https://github.com/vernonzheng/scala-for-the-Impatient" target="_blank" rel="external">https://github.com/vernonzheng/scala-for-the-Impatient</a></p>
<p>书为第一版。scala为2.11.4，jdk1.7.45，操作系统Mac OS X Yosemite 10.10.1。</p>
<h2 id="第六章_对象">第六章 对象</h2>
<p><strong>6.1</strong><br>编写一个 Conversions 对象，加入 inchesToCentimeters,gallonsToLiters 和 milesToKilometers 方法</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">object</span> <span class="title">Conversions</span></span>{</div><div class="line">  <span class="keyword">def</span> inchesToSantimeters(value: Double) = value * <span class="number">2.54</span></div><div class="line">  <span class="keyword">def</span> gallonsToLiters(value: Double) = value * <span class="number">3.78541178</span></div><div class="line">  <span class="keyword">def</span> milesToKilometers(value: Double) = value * <span class="number">1.609344</span></div><div class="line">}</div></pre></td></tr></table></figure>

<p><strong>6.2</strong><br>前一个练习不是很面向对象。提供一个通用的超类 UnitConversion并定义扩展该超类的 InchesToCentimeters,GallonsToLiters 和 MilesToKilometers 对象</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">UnitConversion</span><span class="params">(val factor: Double)</span> </span>{</div><div class="line">	<span class="keyword">def</span> convert(value: Double): Double = factor * value</div><div class="line">}</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">object</span> <span class="title">InchesToSantimeters</span> <span class="keyword">extends</span> <span class="title">UnitConversion</span><span class="params">(2.54)</span></span></div><div class="line"><span class="class"><span class="keyword">object</span> <span class="title">GallonsToLiters</span> <span class="keyword">extends</span> <span class="title">UnitConversion</span><span class="params">(3.78541178)</span></span></div><div class="line"><span class="class"><span class="keyword">object</span> <span class="title">MilesToKilometers</span> <span class="keyword">extends</span> <span class="title">UnitConversion</span><span class="params">(1.609344)</span></span></div></pre></td></tr></table></figure>

<p><strong>6.3</strong><br>定义一个扩展自 java.awt.Point 的 Origin 对象。为什么说这实际上不是个好主意？(仔细看 Point 类的方法)Point 中的 getLocation 方法返回的是 Point 对象，如果想返回 Origin 对象，需要 Origin 类才行</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> java.awt.Point</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">object</span> <span class="title">Origin</span> <span class="keyword">extends</span> <span class="title">Point</span></span>{</div><div class="line">  <span class="keyword">override</span> <span class="keyword">def</span> getLocation : Point = <span class="keyword">super</span>.getLocation</div><div class="line">}</div></pre></td></tr></table></figure>

<p><strong>6.4</strong><br>定义一个 Point 类和一个伴生对象,使得我们可以不用 new 而直接用 Point(3,4)来构造 Point 实例 apply 方法的使用</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Point</span><span class="params">(x: Int = 0, y: Int = 0)</span> <span class="keyword">extends</span> <span class="title">java</span>.<span class="title">awt</span>.<span class="title">Point</span><span class="params">(x, y)</span></span></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">object</span> <span class="title">Point</span> </span>{</div><div class="line">	<span class="keyword">def</span> apply(x: Int = <span class="number">0</span>, y: Int = <span class="number">0</span>) = <span class="keyword">new</span> Point(x, y)</div><div class="line">}</div></pre></td></tr></table></figure>

<p><strong>6.5</strong><br>编写一个 Scala 应用程序,使用 App 特质,以反序打印命令行参数,用空格隔开。举例来说,scala Reverse Hello World 应该打印 World Hello</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">object</span> <span class="title">Reverse</span> <span class="keyword">extends</span> <span class="title">App</span></span>{</div><div class="line">  args.reverse.mkString(<span class="string">" "</span>)</div><div class="line">}</div></pre></td></tr></table></figure>

<p><strong>6.6</strong><br>编写一个扑克牌 4 种花色的枚举,让其 toString 方法分别返回♣,♦,♥,♠</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">object</span> <span class="title">Suits</span> <span class="keyword">extends</span> <span class="title">Enumeration</span></span>{</div><div class="line">  <span class="keyword">type</span> Suits = Value</div><div class="line">  <span class="keyword">val</span> Spade = Value(<span class="string">"♠"</span>)</div><div class="line">  <span class="keyword">val</span> Club = Value(<span class="string">"♣"</span>)</div><div class="line">  <span class="keyword">val</span> Heart = Value(<span class="string">"♥"</span>)</div><div class="line">  <span class="keyword">val</span> Diamond = Value(<span class="string">"♦"</span>)</div><div class="line">  <span class="keyword">override</span> <span class="keyword">def</span> toString():String={</div><div class="line">    Suits.values.mkString(<span class="string">","</span>)</div><div class="line">  }</div><div class="line">}</div></pre></td></tr></table></figure>

<p><strong>6.7</strong><br>实现一个函数,检查某张牌的花色是否为红色</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">object</span> <span class="title">Suits</span> <span class="keyword">extends</span> <span class="title">Enumeration</span> </span>{</div><div class="line">  <span class="keyword">type</span> Suits = Value</div><div class="line">  <span class="keyword">val</span> Spade = Value(<span class="string">"♠"</span>)</div><div class="line">  <span class="keyword">val</span> Club = Value(<span class="string">"♣"</span>)</div><div class="line">  <span class="keyword">val</span> Heart = Value(<span class="string">"♥"</span>)</div><div class="line">  <span class="keyword">val</span> Diamond = Value(<span class="string">"♦"</span>)</div><div class="line">  <span class="keyword">def</span> isRed(card: Suits) = card == Heart || card == Diamond</div><div class="line">}</div></pre></td></tr></table></figure>

<p><strong>6.8</strong><br>编写一个枚举,描述 RGB 立方体的 8 个角。ID 使用颜色值(例如 :红色是 0xff0000)</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">object</span> <span class="title">RGBCube</span> <span class="keyword">extends</span> <span class="title">Enumeration</span> </span>{</div><div class="line">	<span class="keyword">val</span> black = Value(<span class="number">0x000000</span>, <span class="string">"Black"</span>)</div><div class="line">	<span class="keyword">val</span> red = Value(<span class="number">0xff0000</span>, <span class="string">"Red"</span>)</div><div class="line">	<span class="keyword">val</span> green = Value(<span class="number">0x00ff00</span>, <span class="string">"Green"</span>)</div><div class="line">	<span class="keyword">val</span> blue = Value(<span class="number">0x0000ff</span>, <span class="string">"Blue"</span>)</div><div class="line">	<span class="keyword">val</span> yellow = Value(<span class="number">0xffff00</span>, <span class="string">"Yellow"</span>)</div><div class="line">	<span class="keyword">val</span> magenta = Value(<span class="number">0xff00ff</span>, <span class="string">"Magenta"</span>)</div><div class="line">	<span class="keyword">val</span> cyan = Value(<span class="number">0x00ffff</span>, <span class="string">"Cyan"</span>)</div><div class="line">	<span class="keyword">val</span> white = Value(<span class="number">0xffffff</span>, <span class="string">"White"</span>)</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keyword">for</span>( c &lt;- RGBCube.values ) println(<span class="string">"0x%06x: %s"</span>.format(c.id, c))</div></pre></td></tr></table></figure>

<hr>
<p>参考：<br>《快学Scala》：<a href="http://book.douban.com/subject/19971952/" target="_blank" rel="external">http://book.douban.com/subject/19971952/</a></p>
<p><strong>（转载本站文章请注明作者和出处 Vernon Zheng(郑雪峰) – vernonzheng.com ，请勿用于任何商业用途）</strong></p>

        
      
    </div>

    <div class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </div>
  </div>


    
      

  <div class="post post-type-normal ">
    <div class="post-header">

      
      
        <h1 class="post-title">
          
          
            
              <a class="post-title-link" href="/2015/01/25/《快学scala》习题解答-第五章-类/">
                《快学scala》习题解答-第五章-类
              </a>
            
          
        </h1>
      

      <div class="post-meta">
        <span class="post-time">
          Posted on 2015-01-25
        </span>

        
          <span class="post-category">
            &nbsp; | &nbsp; In
            
              <a href="/categories/scala/">scala</a>

              
              

            
          </span>
        

        
          
            <span class="post-comments-count">
            &nbsp; | &nbsp;
            <a href="/2015/01/25/《快学scala》习题解答-第五章-类/#comments" >
              <span class="post-comments-count ds-thread-count" data-thread-key="2015/01/25/《快学scala》习题解答-第五章-类/"></span>
            </a>
          </span>
          
        
      </div>
    </div>

    <div class="post-body">

      
      

      
        
          <pre><code>《快学Scala》（英文版：《Scala <span class="keyword">for</span> <span class="operator">the</span> Impatient》），代码已传github：
</code></pre><p><a href="https://github.com/vernonzheng/scala-for-the-Impatient" target="_blank" rel="external">https://github.com/vernonzheng/scala-for-the-Impatient</a></p>
<p>书为第一版。scala为2.11.4，jdk1.7.45，操作系统Mac OS X Yosemite 10.10.1。</p>
<h2 id="第五章_类">第五章 类</h2>
<p><strong>5.1</strong><br>改进5.1节的Counter类,让它不要在Int.MaxValue时变成负数</p>
<p>答：</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Counter</span><span class="params">()</span></span>{</div><div class="line">  <span class="keyword">private</span> <span class="keyword">var</span> value = <span class="number">0</span></div><div class="line">  <span class="keyword">def</span> increment(){ <span class="keyword">if</span>(value&lt;Int.MaxValue) value += <span class="number">1</span> }</div><div class="line">  <span class="keyword">def</span> current() = value</div><div class="line">}</div></pre></td></tr></table></figure>

<p><strong>5.2</strong><br>编写一个BankAccount类，加入deposit和withdraw方法，和一个只读的balance属性</p>
<p>答：</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">BankAccount</span></span>{</div><div class="line">  <span class="keyword">private</span> <span class="keyword">val</span> banlance = <span class="number">0</span></div><div class="line">  <span class="keyword">def</span> deposit(){}</div><div class="line">  <span class="keyword">def</span> withdraw(){}</div><div class="line">}</div></pre></td></tr></table></figure>

<p><strong>5.3</strong><br>编写一个Time类，加入只读属性hours和minutes，和一个检查某一时刻是否早于另一时刻的方法before(other:Time):Boolean。Time对象应该以new Time(hrs,min)方式构建。其中hrs以军用时间格式呈现(介于0和23之间)</p>
<p>答：</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Time</span><span class="params">(private[this] val hrs:Int,private[this] val min:Int)</span></span>{</div><div class="line">  <span class="keyword">val</span> hours = hrs</div><div class="line">  <span class="keyword">val</span> minutes = min</div><div class="line">  <span class="keyword">def</span> before(other:Time):Boolean = {</div><div class="line">    <span class="keyword">if</span>(hours&lt;other.hours)</div><div class="line">      <span class="keyword">true</span></div><div class="line">    <span class="keyword">if</span>(hours==other.hours)</div><div class="line">      <span class="keyword">if</span>(minutes&lt;other.minutes)</div><div class="line">        <span class="keyword">true</span></div><div class="line">    <span class="keyword">false</span></div><div class="line">  }</div><div class="line">}</div></pre></td></tr></table></figure>

<p><strong>5.4</strong><br>重新实现前一个类中的Time类，将内部呈现改成午夜起的分钟数(介于0到24*60-1之间)。不要改变公有接口。也就是说，客户端代码不应因你的修改而受影响</p>
<p>答：</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Time</span><span class="params">(private[this] val hrs:Int,private[this] val min:Int)</span></span>{</div><div class="line">  <span class="keyword">val</span> minutesInDay = hrs*<span class="number">24</span>+min</div><div class="line">  <span class="keyword">def</span> before(other:Time):Boolean = {</div><div class="line">    <span class="keyword">if</span>(minutesInDay&lt;other.minutesInDay)</div><div class="line">      <span class="keyword">true</span></div><div class="line">    <span class="keyword">false</span></div><div class="line">  }</div><div class="line">}</div></pre></td></tr></table></figure>

<p><strong>5.5</strong><br>创建一个Student类，加入可读写的JavaBeans属性name(类型为String)和id(类型为Long)。有哪些方法被生产？(用javap查看。)你可以在Scala中调用JavaBeans的getter和setter方法吗？应该这样做吗？</p>
<p>答：</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> scala.beans.BeanProperty</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span></span>{</div><div class="line">  <span class="annotation">@BeanProperty</span> <span class="keyword">var</span> name:String = _</div><div class="line">  <span class="annotation">@BeanProperty</span> <span class="keyword">var</span> id:Long = _</div><div class="line">}</div><div class="line"><span class="javadoc">/**</span></div><div class="line">javap -c Student 后显示如下</div><div class="line"></div><div class="line">Compiled from "Student.scala"</div><div class="line">public class Student extends java.lang.Object implements scala.ScalaObject{</div><div class="line">  public java.lang.String name();</div><div class="line">  Code:</div><div class="line">  0:   aload_0</div><div class="line">  1:   getfield        #13; //Field name:Ljava/lang/String;</div><div class="line">  4:   areturn</div><div class="line"></div><div class="line">  public void name_$eq(java.lang.String);</div><div class="line">  Code:</div><div class="line">  0:   aload_0</div><div class="line">  1:   aload_1</div><div class="line">  2:   putfield        #13; //Field name:Ljava/lang/String;</div><div class="line">  5:   return</div><div class="line"></div><div class="line">  public void setName(java.lang.String);</div><div class="line">  Code:</div><div class="line">  0:   aload_0</div><div class="line">  1:   aload_1</div><div class="line">  2:   putfield        #13; //Field name:Ljava/lang/String;</div><div class="line">  5:   return</div><div class="line"></div><div class="line">  public long id();</div><div class="line">  Code:</div><div class="line">  0:   aload_0</div><div class="line">  1:   getfield        #19; //Field id:J</div><div class="line">  4:   lreturn</div><div class="line"></div><div class="line">  public void id_$eq(long);</div><div class="line">  Code:</div><div class="line">  0:   aload_0</div><div class="line">  1:   lload_1</div><div class="line">  2:   putfield        #19; //Field id:J</div><div class="line">  5:   return</div><div class="line"></div><div class="line">  public void setId(long);</div><div class="line">  Code:</div><div class="line">  0:   aload_0</div><div class="line">  1:   lload_1</div><div class="line">  2:   putfield        #19; //Field id:J</div><div class="line">  5:   return</div><div class="line"></div><div class="line">  public long getId();</div><div class="line">  Code:</div><div class="line">  0:   aload_0</div><div class="line">  1:   invokevirtual   #25; //Method id:()J</div><div class="line">  4:   lreturn</div><div class="line"></div><div class="line">  public java.lang.String getName();</div><div class="line">  Code:</div><div class="line">  0:   aload_0</div><div class="line">  1:   invokevirtual   #28; //Method name:()Ljava/lang/String;</div><div class="line">  4:   areturn</div><div class="line"></div><div class="line">  public Student();</div><div class="line">  Code:</div><div class="line">  0:   aload_0</div><div class="line">  1:   invokespecial   #34; //Method java/lang/Object."&lt;init&gt;":()V</div><div class="line">  4:   return</div><div class="line"></div><div class="line">}</div><div class="line">  **/</div></pre></td></tr></table></figure>

<p><strong>5.6</strong><br>在5.2节的Person类中提供一个主构造器,将负年龄转换为0</p>
<p>答：</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span><span class="params">(var age:Int)</span></span>{</div><div class="line">  age = <span class="keyword">if</span>(age &lt; <span class="number">0</span>) <span class="number">0</span> <span class="keyword">else</span> age</div><div class="line">}</div></pre></td></tr></table></figure>

<p><strong>5.7</strong><br>编写一个Person类，其主构造器接受一个字符串，该字符串包含名字，空格和姓，如new Person(“Fred Smith”)。提供只读属性firstName和lastName。主构造器参数应该是var,val还是普通参数？为什么？</p>
<p>答：</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span><span class="params">(private[this] val name:String)</span></span>{</div><div class="line">  <span class="keyword">private</span>[<span class="keyword">this</span>] <span class="keyword">val</span> tmp = name.split(<span class="string">"\\s+"</span>)</div><div class="line">  <span class="keyword">val</span> firstName = tmp(<span class="number">0</span>)</div><div class="line">  <span class="keyword">val</span> lastName = tmp(<span class="number">1</span>)</div><div class="line">}</div></pre></td></tr></table></figure>

<p><strong>5.8</strong><br>创建一个Car类，以只读属性对应制造商，型号名称，型号年份以及一个可读写的属性用于车牌。提供四组构造器。每个构造器fc都要求制造商和型号为必填。型号年份和车牌可选，如果未填，则型号年份为-1，车牌为空串。你会选择哪一个作为你的主构造器？为什么？</p>
<p>答：</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Car</span><span class="params">(val manufactuer:String, val model: String, val year: Int = -1, var license: String = <span class="string">""</span>)</span></span></div></pre></td></tr></table></figure>

<p><strong>5.9</strong><br>在Java,C#或C++重做前一个练习。Scala相比之下精简多少？</p>
<p>答：<br>略</p>
<p><strong>5.10</strong><br>考虑如下的类</p>
<p>class Employ(val name:String,var salary:Double){<br>    def this(){this(“John Q. Public”,0.0)}<br>}<br>重写该类,使用显示的字段定义，和一个缺省主构造器。你更倾向于使用哪种形式？为什么？</p>
<p>答：</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Employ</span><span class="params">()</span></span>{</div><div class="line">  <span class="keyword">val</span> name:String = <span class="string">"John Q. Public"</span></div><div class="line">  <span class="keyword">var</span> salary:Double = <span class="number">0.0</span></div><div class="line">}</div></pre></td></tr></table></figure>

<hr>
<p>参考：<br>《快学Scala》：<a href="http://book.douban.com/subject/19971952/" target="_blank" rel="external">http://book.douban.com/subject/19971952/</a></p>
<p><strong>（转载本站文章请注明作者和出处 Vernon Zheng(郑雪峰) – vernonzheng.com ，请勿用于任何商业用途）</strong></p>

        
      
    </div>

    <div class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </div>
  </div>


    
      

  <div class="post post-type-normal ">
    <div class="post-header">

      
      
        <h1 class="post-title">
          
          
            
              <a class="post-title-link" href="/2015/01/25/《快学scala》习题解答-第四章-映射与元组/">
                《快学scala》习题解答-第四章-映射与元组
              </a>
            
          
        </h1>
      

      <div class="post-meta">
        <span class="post-time">
          Posted on 2015-01-25
        </span>

        
          <span class="post-category">
            &nbsp; | &nbsp; In
            
              <a href="/categories/scala/">scala</a>

              
              

            
          </span>
        

        
          
            <span class="post-comments-count">
            &nbsp; | &nbsp;
            <a href="/2015/01/25/《快学scala》习题解答-第四章-映射与元组/#comments" >
              <span class="post-comments-count ds-thread-count" data-thread-key="2015/01/25/《快学scala》习题解答-第四章-映射与元组/"></span>
            </a>
          </span>
          
        
      </div>
    </div>

    <div class="post-body">

      
      

      
        
          <pre><code>《快学Scala》（英文版：《Scala <span class="keyword">for</span> <span class="operator">the</span> Impatient》），代码已传github：
</code></pre><p><a href="https://github.com/vernonzheng/scala-for-the-Impatient" target="_blank" rel="external">https://github.com/vernonzheng/scala-for-the-Impatient</a></p>
<p>书为第一版。scala为2.11.4，jdk1.7.45，操作系统Mac OS X Yosemite 10.10.1。</p>
<h2 id="第四章_映射和元组">第四章 映射和元组</h2>
<p><strong>4.1</strong><br>设置一个映射,其中包含你想要的一些装备，以及它们的价格。然后构建另一个映射，采用同一组键，但是价格上打9折</p>
<p>答：</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">def</span> buildEquipMap() :Map[String,Double] = {</div><div class="line">  <span class="keyword">val</span> equipMap:Map[String,Double] = Map(<span class="string">"eq1"</span>-&gt;<span class="number">11.1</span>,<span class="string">"eq2"</span>-&gt;<span class="number">12.2</span>,<span class="string">"eq3"</span>-&gt;<span class="number">14</span>)</div><div class="line">  <span class="keyword">for</span> ((k,v) &lt;- equipMap) <span class="keyword">yield</span> (k,v*<span class="number">0.9</span>)</div><div class="line">}</div></pre></td></tr></table></figure>

<p><strong>4.2</strong><br>编写一段程序，从文件中读取单词。用一个可变映射来清点每个单词出现的频率。读取这些单词的操作可以使用java.util.Scanner</p>
<p>答：</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> scala.collection.mutable</div><div class="line"><span class="keyword">import</span> scala.io.Source</div><div class="line"></div><div class="line"><span class="keyword">def</span> countWord() : Unit = {</div><div class="line">  <span class="keyword">val</span> wordMap = <span class="keyword">new</span> mutable.HashMap[String,Int]</div><div class="line">  <span class="keyword">val</span> in = <span class="keyword">new</span> java.util.Scanner(<span class="keyword">new</span> java.io.File(<span class="string">"exercise02.txt"</span>))</div><div class="line">  <span class="keyword">while</span>(in.hasNext){</div><div class="line">    <span class="keyword">val</span> word = in.next()</div><div class="line">    wordMap(word) = wordMap.getOrElse(word,<span class="number">0</span>) + <span class="number">1</span></div><div class="line">  }</div><div class="line">  println(wordMap.mkString(<span class="string">","</span>))</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keyword">def</span> countWord2() : Unit = {</div><div class="line">  <span class="keyword">val</span> source = Source.fromFile(<span class="string">"exercise02.txt"</span>).mkString</div><div class="line">  <span class="keyword">val</span> tokens = source.split(<span class="string">"\\s+"</span>)</div><div class="line">  <span class="keyword">val</span> wordMap = <span class="keyword">new</span> mutable.HashMap[String,Int]</div><div class="line">  <span class="keyword">for</span>(word &lt;- tokens){</div><div class="line">    wordMap(word) = wordMap.getOrElse(word,<span class="number">0</span>) + <span class="number">1</span></div><div class="line">  }</div><div class="line">  println(wordMap.mkString(<span class="string">","</span>))</div><div class="line">}</div></pre></td></tr></table></figure>

<p><strong>4.3</strong><br>重复前一个练习，这次用不可变的映射</p>
<p>答：</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div></pre></td><td class="code"><pre><div class="line">mport scala.collection.{mutable, immutable}</div><div class="line"><span class="keyword">import</span> scala.io.Source</div><div class="line"></div><div class="line"><span class="keyword">def</span> countWord() : Unit = {</div><div class="line">  <span class="keyword">val</span> source = Source.fromFile(<span class="string">"exercise02.txt"</span>).mkString</div><div class="line">  <span class="keyword">val</span> tokens = source.split(<span class="string">"\\s+"</span>)</div><div class="line">  <span class="keyword">var</span> wordMap = <span class="keyword">new</span> immutable.HashMap[String,Int]</div><div class="line">  <span class="keyword">for</span>(key &lt;- tokens){</div><div class="line">    wordMap += (key -&gt; (wordMap.getOrElse(key,<span class="number">0</span>) + <span class="number">1</span>))</div><div class="line">  }</div><div class="line">  println(wordMap.mkString(<span class="string">","</span>))</div><div class="line">}</div><div class="line"></div><div class="line"><span class="javadoc">/**</span></div><div class="line"> * 书中:immutable map += 不断生成新的map，由于都是immutable，共享大部分数据结构，</div><div class="line"> * 测试下性能</div><div class="line"> */</div><div class="line"><span class="keyword">def</span> countWord1(tokens:Array[String]) : Unit = {</div><div class="line">  <span class="keyword">val</span> wordMap = <span class="keyword">new</span> mutable.HashMap[String,Int]</div><div class="line">  <span class="keyword">for</span>(word &lt;- tokens){</div><div class="line">    wordMap(word) = wordMap.getOrElse(word,<span class="number">0</span>) + <span class="number">1</span></div><div class="line">  }</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keyword">def</span> countWord2(tokens:Array[String]) : Unit = {</div><div class="line">  <span class="keyword">val</span> wordMap = <span class="keyword">new</span> mutable.HashMap[String,Int]</div><div class="line">  <span class="keyword">for</span>(word &lt;- tokens){</div><div class="line">    wordMap(word) = wordMap.getOrElse(word,<span class="number">0</span>) + <span class="number">1</span></div><div class="line">  }</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keyword">def</span> performance():Unit={</div><div class="line">  <span class="keyword">val</span> source = Source.fromFile(<span class="string">"exercise02.txt"</span>).mkString</div><div class="line">  <span class="keyword">val</span> tokens = source.split(<span class="string">"\\s+"</span>)</div><div class="line">  <span class="keyword">val</span> startTime1 = System.currentTimeMillis()</div><div class="line">  <span class="keyword">for</span>(i &lt;- <span class="number">0</span> to <span class="number">10000</span>) {</div><div class="line">    countWord1(tokens)</div><div class="line">  }</div><div class="line">  <span class="keyword">val</span> endTime1 = System.currentTimeMillis()</div><div class="line">  <span class="keyword">val</span> startTime2 = System.currentTimeMillis()</div><div class="line">  <span class="keyword">for</span>(i &lt;- <span class="number">0</span> to <span class="number">10000</span>) {</div><div class="line">    countWord2(tokens)</div><div class="line">  }</div><div class="line">  <span class="keyword">val</span> endTime2 = System.currentTimeMillis()</div><div class="line">  println(<span class="string">"countWord1(mutable map) cost:"</span>+(endTime1-startTime1))</div><div class="line">  println(<span class="string">"countWord2(immutable map) cost:"</span>+(endTime2-startTime2))</div><div class="line"></div><div class="line">  <span class="javadoc">/**</span></div><div class="line">   * scala&gt; performance</div><div class="line">countWord1(mutable map) cost:36</div><div class="line">countWord2(immutable map) cost:34</div><div class="line"></div><div class="line">scala&gt; performance</div><div class="line">countWord1(mutable map) cost:4</div><div class="line">countWord2(immutable map) cost:4</div><div class="line"></div><div class="line">scala&gt; performance</div><div class="line">countWord1(mutable map) cost:8</div><div class="line">countWord2(immutable map) cost:6</div><div class="line"></div><div class="line">scala&gt; performance</div><div class="line">countWord1(mutable map) cost:4</div><div class="line">countWord2(immutable map) cost:8</div><div class="line"></div><div class="line">scala&gt; performance</div><div class="line">countWord1(mutable map) cost:5</div><div class="line">countWord2(immutable map) cost:4</div><div class="line">   */</div><div class="line">}</div></pre></td></tr></table></figure>

<p><strong>4.4</strong><br>重复前一个练习，这次使用已排序的映射，以便单词可以按顺序打印出来</p>
<p>答：</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> scala.collection.immutable.TreeMap</div><div class="line"><span class="keyword">import</span> scala.io.Source</div><div class="line"></div><div class="line"><span class="keyword">def</span> countWord() : Unit = {</div><div class="line">  <span class="keyword">val</span> source = Source.fromFile(<span class="string">"exercise02.txt"</span>).mkString</div><div class="line">  <span class="keyword">val</span> tokens = source.split(<span class="string">"\\s+"</span>)</div><div class="line">  <span class="keyword">var</span> wordMap = <span class="keyword">new</span> TreeMap[String,Int]</div><div class="line">  <span class="keyword">for</span>(key &lt;- tokens){</div><div class="line">    wordMap += (key -&gt; (wordMap.getOrElse(key,<span class="number">0</span>) + <span class="number">1</span>))</div><div class="line">  }</div><div class="line">  println(wordMap.mkString(<span class="string">","</span>))</div><div class="line">}</div></pre></td></tr></table></figure>

<p><strong>4.5</strong><br>重复前一个练习，这次使用java.util.TreeMap并使之适用于Scala API</p>
<p>答：</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> java.util</div><div class="line"><span class="keyword">import</span> scala.collection.mutable.Map</div><div class="line"><span class="keyword">import</span> scala.collection.JavaConversions.mapAsScalaMap</div><div class="line"><span class="keyword">import</span> scala.io.Source</div><div class="line"></div><div class="line"><span class="keyword">def</span> countWord() : Unit = {</div><div class="line">  <span class="keyword">val</span> source = Source.fromFile(<span class="string">"exercise02.txt"</span>).mkString</div><div class="line">  <span class="keyword">val</span> tokens = source.split(<span class="string">"\\s+"</span>)</div><div class="line">  <span class="keyword">var</span> wordMap:Map[String,Int] = <span class="keyword">new</span> util.TreeMap[String,Int]</div><div class="line">  <span class="keyword">for</span>(key &lt;- tokens){</div><div class="line">    wordMap += (key -&gt; (wordMap.getOrElse(key,<span class="number">0</span>) + <span class="number">1</span>))</div><div class="line">  }</div><div class="line">  println(wordMap.mkString(<span class="string">","</span>))</div><div class="line">}</div></pre></td></tr></table></figure>

<p><strong>4.6</strong><br>定义一个链式哈希映射,将”Monday”映射到java.util.Calendar.MONDAY,依次类推加入其他日期。展示元素是以插入的顺序被访问的</p>
<p>答：</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> java.util.Calendar</div><div class="line"><span class="keyword">import</span> scala.collection.mutable</div><div class="line"></div><div class="line"><span class="keyword">def</span> calendarDays():Unit = {</div><div class="line">  <span class="keyword">val</span> daysMap = mutable.LinkedHashMap(</div><div class="line">    <span class="string">"Monday"</span> -&gt; Calendar.MONDAY,</div><div class="line">    <span class="string">"Tuesday"</span> -&gt; Calendar.TUESDAY,</div><div class="line">    <span class="string">"Wednesday"</span> -&gt; Calendar.WEDNESDAY,</div><div class="line">    <span class="string">"Thursday"</span> -&gt; Calendar.THURSDAY,</div><div class="line">    <span class="string">"Friday"</span> -&gt; Calendar.FRIDAY,</div><div class="line">    <span class="string">"Saturday"</span> -&gt; Calendar.SATURDAY,</div><div class="line">    <span class="string">"Sunday"</span> -&gt; Calendar.SUNDAY</div><div class="line">  )</div><div class="line">  println(daysMap.mkString(<span class="string">","</span>))</div><div class="line">}</div></pre></td></tr></table></figure>

<p><strong>4.7</strong><br>打印出所有Java系统属性的表格</p>
<p>答：</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> scala.collection.JavaConversions.propertiesAsScalaMap</div><div class="line"></div><div class="line"><span class="keyword">def</span> printJavaSysProps():Unit = {</div><div class="line">  <span class="keyword">val</span> propMap:collection.Map[String,String] = System.getProperties()</div><div class="line">  <span class="keyword">val</span> maxKeyLength = propMap.keySet.map(_.length).max</div><div class="line">  <span class="keyword">for</span>( (k,v) &lt;- propMap ) printf(<span class="string">"%-"</span> + maxKeyLength + <span class="string">"s | %s\n"</span>, k, v)</div><div class="line">}</div></pre></td></tr></table></figure>

<p><strong>4.8</strong><br>编写一个函数minmax(values:Array[Int]),返回数组中最小值和最大值的对偶</p>
<p>答：</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">def</span> minmax(values:Array[Int])={</div><div class="line">  (values.max,values.min)</div><div class="line">}</div></pre></td></tr></table></figure>

<p><strong>4.9</strong><br>编写一个函数Iteqgt(values:Array[int],v:Int),返回数组中小于v,等于v和大于v的数量，要求三个值一起返回</p>
<p>答：</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">def</span> Iteqgt(values:Array[Int],v:Int){</div><div class="line">  (values.count(_ &lt; v),values.count(_ == v),values.count(_ &gt; v))</div><div class="line">}</div></pre></td></tr></table></figure>

<p><strong>4.10</strong><br>当你将两个字符串拉链在一起，比如”Hello”.zip(“World”)，会是什么结果？想出一个讲得通的用例</p>
<p>答：</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">scala&gt; <span class="string">"Hello"</span>.zip(<span class="string">"hello"</span>).toMap</div><div class="line">res40: scala.collection.immutable.Map[Char,Char] = Map(H -&gt; h, e -&gt; e, l -&gt; l, o -&gt; o)</div></pre></td></tr></table></figure>

<p>StringOps中的zip定义如下:</p>
<p>abstract def zip<a href="that: GenIterable[B]" target="_blank" rel="external">B</a>: StringOps[(A, B)]<br>GenIterable是可遍历对象需要包含的trait，对于String来说，它是可遍历的。但是它的遍历是遍历单个字母。 所以拉链就针对每个字母来进行。</p>
<hr>
<p>参考：<br>《快学Scala》：<a href="http://book.douban.com/subject/19971952/" target="_blank" rel="external">http://book.douban.com/subject/19971952/</a></p>
<p><strong>（转载本站文章请注明作者和出处 Vernon Zheng(郑雪峰) – vernonzheng.com ，请勿用于任何商业用途）</strong></p>

        
      
    </div>

    <div class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </div>
  </div>


    
      

  <div class="post post-type-normal ">
    <div class="post-header">

      
      
        <h1 class="post-title">
          
          
            
              <a class="post-title-link" href="/2015/01/21/《快学scala》习题解答-第三章-数组相关操作/">
                《快学scala》习题解答-第三章-数组相关操作
              </a>
            
          
        </h1>
      

      <div class="post-meta">
        <span class="post-time">
          Posted on 2015-01-21
        </span>

        
          <span class="post-category">
            &nbsp; | &nbsp; In
            
              <a href="/categories/scala/">scala</a>

              
              

            
          </span>
        

        
          
            <span class="post-comments-count">
            &nbsp; | &nbsp;
            <a href="/2015/01/21/《快学scala》习题解答-第三章-数组相关操作/#comments" >
              <span class="post-comments-count ds-thread-count" data-thread-key="2015/01/21/《快学scala》习题解答-第三章-数组相关操作/"></span>
            </a>
          </span>
          
        
      </div>
    </div>

    <div class="post-body">

      
      

      
        
          <pre><code>《快学Scala》（英文版：《Scala <span class="keyword">for</span> <span class="operator">the</span> Impatient》），代码已传github：
</code></pre><p><a href="https://github.com/vernonzheng/scala-for-the-Impatient" target="_blank" rel="external">https://github.com/vernonzheng/scala-for-the-Impatient</a></p>
<p>书为第一版。scala为2.11.4，jdk1.7.45，操作系统Mac OS X Yosemite 10.10.1。</p>
<h2 id="第三章_数组相关操作">第三章 数组相关操作</h2>
<p><strong>3.1</strong><br>编写一段代码，将a设置为一个n个随机整数的数组，要求随机数介于0(包含)和n(不包含)之间</p>
<p>答：</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> scala.util.Random</div><div class="line"><span class="keyword">import</span> scala.math.random</div><div class="line"><span class="keyword">def</span> randomArray(n: Int) :Array[Int] = {</div><div class="line">  <span class="keyword">val</span> array = <span class="keyword">for</span>( i&lt;- <span class="number">0</span> to n) <span class="keyword">yield</span> Random.nextInt(n)</div><div class="line">  array.toArray</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keyword">def</span> randomArray2(n: Int) :Array[Int] = {</div><div class="line">  <span class="keyword">val</span> array = <span class="keyword">for</span>( i&lt;- <span class="number">0</span> to n) <span class="keyword">yield</span> (random * n).toInt</div><div class="line">  array.toArray</div><div class="line">}</div></pre></td></tr></table></figure>

<p><strong>3.2</strong><br>编写一个循环，将整数数组中相邻的元素置换。例如,Array(1,2,3,4,5)经过置换后变为Array(2,1,4,3,5)</p>
<p>答：</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">def</span> arrayChange(array: Array[Int]) :Array[Int] = {</div><div class="line">  <span class="keyword">if</span>(array == <span class="keyword">null</span>)</div><div class="line">    <span class="keyword">return</span> <span class="keyword">null</span></div><div class="line"></div><div class="line">  <span class="keyword">for</span>(i &lt;- <span class="number">0</span> until array.length <span class="keyword">if</span> i % <span class="number">2</span> ==<span class="number">0</span> && i &gt; <span class="number">0</span>){</div><div class="line">    <span class="keyword">val</span> tmp = array(i-<span class="number">1</span>)</div><div class="line">    array(i-<span class="number">1</span>) = array(i)</div><div class="line">    array(i) = tmp</div><div class="line">  }</div><div class="line">  array</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keyword">def</span> arrayChange2(arr: Array[Int]) :Array[Int] = {</div><div class="line">  <span class="keyword">val</span> t = arr.toBuffer</div><div class="line">  <span class="keyword">for</span>(i &lt;- <span class="number">0</span> until (t.length,<span class="number">2</span>) <span class="keyword">if</span> i + <span class="number">1</span> &lt; t.length){</div><div class="line">    <span class="keyword">val</span> a = t(i)</div><div class="line">    <span class="keyword">val</span> b = t(i + <span class="number">1</span>)</div><div class="line">    t.remove(i,<span class="number">2</span>)</div><div class="line">    t.insert(i,b)</div><div class="line">    t.insert(i + <span class="number">1</span>,a)</div><div class="line">  }</div><div class="line">  t.toArray</div><div class="line">}</div></pre></td></tr></table></figure>

<p><strong>3.3</strong><br>重复前一个练习，不过这一次生成一个新的值交换过的数组。用for/yield</p>
<p>答：</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">def</span> arrayChange(array: Array[Int]) :Array[Int] = {</div><div class="line">  <span class="keyword">if</span>(array == <span class="keyword">null</span>)</div><div class="line">    <span class="keyword">return</span> <span class="keyword">null</span></div><div class="line"></div><div class="line">  <span class="keyword">val</span> length = array.length</div><div class="line">  <span class="keyword">var</span> flag = <span class="keyword">true</span></div><div class="line">  <span class="keyword">val</span> newArray = <span class="keyword">for</span>(i &lt;- <span class="number">0</span> until length <span class="keyword">if</span> flag) <span class="keyword">yield</span>{</div><div class="line">    <span class="keyword">var</span> item = <span class="number">0</span></div><div class="line">    <span class="keyword">if</span>(i+<span class="number">1</span> &gt;= length){</div><div class="line">      flag = <span class="keyword">false</span></div><div class="line">    }</div><div class="line">    <span class="keyword">if</span>(i%<span class="number">2</span> == <span class="number">0</span>){</div><div class="line">      item = array(i+<span class="number">1</span>)</div><div class="line">    }<span class="keyword">else</span> <span class="keyword">if</span>(i%<span class="number">2</span> == <span class="number">1</span>){</div><div class="line">      item = array(i-<span class="number">1</span>)</div><div class="line">    }</div><div class="line">    item</div><div class="line">  }</div><div class="line">  newArray.toArray</div><div class="line">}</div></pre></td></tr></table></figure>

<p><strong>3.4</strong><br>给定一个整数数组，产生一个新的数组，包含元数组中的所有正值，以原有顺序排列，之后的元素是所有零或负值，以原有顺序排列</p>
<p>答：</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">def</span> sortArray(array:Array[Int]):Array[Int] = {</div><div class="line">  <span class="keyword">val</span> newArrayBuffer = <span class="keyword">new</span> ArrayBuffer[Int]()</div><div class="line">  <span class="keyword">val</span> positiveIndex = <span class="keyword">for</span>(i &lt;- <span class="number">0</span> to array.length <span class="keyword">if</span> array(i) &gt; <span class="number">0</span> ) <span class="keyword">yield</span> {array(i)}</div><div class="line">  newArrayBuffer ++= positiveIndex.toBuffer</div><div class="line">  newArrayBuffer ++= (<span class="keyword">for</span>(i &lt;- <span class="number">0</span> to array.length <span class="keyword">if</span> !positiveIndex.contains(i)) <span class="keyword">yield</span>{array(i)}).toBuffer</div><div class="line">  newArrayBuffer.toArray</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keyword">def</span> sortArray2(array:Array[Int]):Array[Int] = {</div><div class="line">  <span class="keyword">val</span> a = ArrayBuffer[Int]()</div><div class="line">  <span class="keyword">val</span> b = ArrayBuffer[Int]()</div><div class="line">  array.foreach(arg =&gt; <span class="keyword">if</span>(arg &gt; <span class="number">0</span>) a += arg <span class="keyword">else</span> b += arg)</div><div class="line">  a ++= b</div><div class="line">  a.toArray</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keyword">def</span> sortArray3(array:Array[Int]):Array[Int] = {</div><div class="line">  <span class="keyword">val</span> a = array.filter(_&gt;<span class="number">0</span>).map(_*<span class="number">1</span>)</div><div class="line">  <span class="keyword">val</span> b = array.filter(_&lt;=<span class="number">0</span>).map(_*<span class="number">1</span>)</div><div class="line">  <span class="keyword">var</span> c = a.toBuffer</div><div class="line">  c ++= b.toBuffer</div><div class="line">  c.toArray</div><div class="line">}</div></pre></td></tr></table></figure>

<p><strong>3.5</strong><br>如何计算Array[Double]的平均值</p>
<p>答：</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">def</span> avgArray(array:Array[Double]):Double={</div><div class="line">  array.sum/array.length</div><div class="line">}</div></pre></td></tr></table></figure>

<p><strong>3.6</strong><br>如何重新组织Array[Int]的元素将他们以反序排列？对于ArrayBuffer[Int]你又会怎么做呢？</p>
<p>答：</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">def</span> reverseArray(arr:Array[Int]):Array[Int]={</div><div class="line">  arr.reverse</div><div class="line">}</div></pre></td></tr></table></figure>

<p><strong>3.7</strong><br>编写一段代码，产出数组中的所有值，去掉重复项。(提示：查看Scaladoc)</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">def</span> removeArray1(arr:Array[Int]):Array[Int]={</div><div class="line">  <span class="keyword">val</span> t = arr.toBuffer</div><div class="line">  <span class="keyword">val</span> idx =(<span class="keyword">for</span>(i &lt;- <span class="number">0</span> until t.length <span class="keyword">if</span> t(i) &lt; <span class="number">0</span>) <span class="keyword">yield</span> { i }).reverse.toBuffer</div><div class="line">  idx.trimEnd(<span class="number">1</span>)</div><div class="line">  idx.foreach(arg =&gt; t.remove(arg))</div><div class="line">  t.toArray</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keyword">def</span> removeArray2(array:Array[Int]):Array[Int]={</div><div class="line">  <span class="keyword">val</span> arr = array.toBuffer</div><div class="line">  <span class="keyword">var</span> first = <span class="keyword">true</span></div><div class="line">  <span class="keyword">val</span> indexes = <span class="keyword">for</span>(i &lt;- <span class="number">0</span> until arr.length <span class="keyword">if</span> first || arr(i) &gt;= <span class="number">0</span>) <span class="keyword">yield</span>{</div><div class="line">    <span class="keyword">if</span>(arr(i) &lt; <span class="number">0</span>) first = <span class="keyword">false</span>;i</div><div class="line">  }</div><div class="line">  <span class="keyword">for</span>(j &lt;- <span class="number">0</span> until indexes.length) arr(j) = arr(indexes(j))</div><div class="line">  arr.trimEnd(arr.length - indexes.length)</div><div class="line">  arr.toArray</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keyword">def</span> performance():Unit={</div><div class="line">  <span class="keyword">val</span> array = Array(<span class="number">1</span>,-<span class="number">2</span>,<span class="number">3</span>,<span class="number">55</span>,<span class="number">3</span>,-<span class="number">4</span>,-<span class="number">6</span>,-<span class="number">2</span>,-<span class="number">1</span>,<span class="number">55</span>,-<span class="number">3</span>,<span class="number">5</span>)</div><div class="line">  <span class="keyword">val</span> startTime1 = System.currentTimeMillis()</div><div class="line">  <span class="keyword">for</span>(i &lt;- <span class="number">0</span> to <span class="number">10000</span>) {</div><div class="line">    removeArray1(array)</div><div class="line">  }</div><div class="line">  <span class="keyword">val</span> endTime1 = System.currentTimeMillis()</div><div class="line">  <span class="keyword">val</span> startTime2 = System.currentTimeMillis()</div><div class="line">  <span class="keyword">for</span>(i &lt;- <span class="number">0</span> to <span class="number">10000</span>) {</div><div class="line">    <span class="keyword">val</span> result2 = removeArray2(array)</div><div class="line">  }</div><div class="line">  <span class="keyword">val</span> endTime2 = System.currentTimeMillis()</div><div class="line">  println(<span class="string">"removeArray1 cost:"</span>+(endTime1-startTime1))</div><div class="line">  println(<span class="string">"removeArray2 cost:"</span>+(endTime2-startTime2))</div><div class="line">  <span class="comment">//10000次 201：81</span></div><div class="line">}</div><div class="line"><span class="javadoc">/**</span></div><div class="line">   * scala&gt; performance</div><div class="line">removeArray1 cost:231</div><div class="line">removeArray2 cost:163</div><div class="line"></div><div class="line">scala&gt; performance</div><div class="line">removeArray1 cost:16</div><div class="line">removeArray2 cost:14</div><div class="line"></div><div class="line">scala&gt; performance</div><div class="line">removeArray1 cost:12</div><div class="line">removeArray2 cost:6</div><div class="line"></div><div class="line">scala&gt; performance</div><div class="line">removeArray1 cost:13</div><div class="line">removeArray2 cost:7</div><div class="line"></div><div class="line">scala&gt; performance</div><div class="line">removeArray1 cost:18</div><div class="line">removeArray2 cost:5</div><div class="line">   */</div></pre></td></tr></table></figure>

<p><strong>3.9</strong><br>创建一个由java.util.TimeZone.getAvailableIDs返回ide时区集合，判断条件是它们在美洲。去掉”America/“前缀并排序</p>
<p>答：</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">def</span> sortAmericaTimeZone():Unit = {</div><div class="line">  <span class="keyword">val</span> array = java.util.TimeZone.getAvailableIDs</div><div class="line">  <span class="keyword">val</span> result = array.filter(_.startsWith(<span class="string">"America"</span>)).map(_.replace(<span class="string">"America/"</span>,<span class="string">""</span>)).sorted</div><div class="line">  result.foreach(println(_))</div><div class="line">}</div></pre></td></tr></table></figure>

<p><strong>3.10</strong><br>引入java.awt.datatransfer.并构建一个类型为SystemFlavorMap类型的对象:<br>  val flavors = SystemFlavorMap.getDefaultFlavorMap().asInstanceOf[SystemFlavorMap]<br>  然后以DataFlavor.imageFlavor为参数调用getNativesForFlavor方法，以Scala缓冲保存返回值。<br> (为什么用这样一个晦涩难懂的类？因为在Java标准库中很难找到使用java.util.List的代码)</p>
<p>答：</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> java.awt.datatransfer.{DataFlavor, SystemFlavorMap}</div><div class="line"><span class="keyword">import</span> collection.JavaConversions.asScalaBuffer</div><div class="line"><span class="keyword">import</span> scala.collection.mutable</div><div class="line"></div><div class="line"><span class="keyword">def</span> test():Unit = {</div><div class="line">  <span class="keyword">val</span> flavors = SystemFlavorMap.getDefaultFlavorMap().asInstanceOf[SystemFlavorMap]</div><div class="line">  <span class="keyword">val</span> res:mutable.Buffer[String] = flavors.getNativesForFlavor(DataFlavor.imageFlavor)</div><div class="line">  println(res)</div><div class="line">}</div></pre></td></tr></table></figure>

<hr>
<p>参考：<br>《快学Scala》：<a href="http://book.douban.com/subject/19971952/" target="_blank" rel="external">http://book.douban.com/subject/19971952/</a></p>
<p><strong>（转载本站文章请注明作者和出处 Vernon Zheng(郑雪峰) – vernonzheng.com ，请勿用于任何商业用途）</strong></p>

        
      
    </div>

    <div class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </div>
  </div>


    
      

  <div class="post post-type-normal ">
    <div class="post-header">

      
      
        <h1 class="post-title">
          
          
            
              <a class="post-title-link" href="/2015/01/20/《快学scala》习题解答-第二章-控制结构和函数/">
                《快学scala》习题解答-第二章-控制结构和函数
              </a>
            
          
        </h1>
      

      <div class="post-meta">
        <span class="post-time">
          Posted on 2015-01-20
        </span>

        
          <span class="post-category">
            &nbsp; | &nbsp; In
            
              <a href="/categories/scala/">scala</a>

              
              

            
          </span>
        

        
          
            <span class="post-comments-count">
            &nbsp; | &nbsp;
            <a href="/2015/01/20/《快学scala》习题解答-第二章-控制结构和函数/#comments" >
              <span class="post-comments-count ds-thread-count" data-thread-key="2015/01/20/《快学scala》习题解答-第二章-控制结构和函数/"></span>
            </a>
          </span>
          
        
      </div>
    </div>

    <div class="post-body">

      
      

      
        
          <pre><code>《快学Scala》（英文版：《Scala <span class="keyword">for</span> <span class="operator">the</span> Impatient》），代码已传github：
</code></pre><p><a href="https://github.com/vernonzheng/scala-for-the-Impatient" target="_blank" rel="external">https://github.com/vernonzheng/scala-for-the-Impatient</a></p>
<p>书为第一版。scala为2.11.4，jdk1.7.45，操作系统Mac OS X Yosemite 10.10.1。</p>
<h2 id="第二章_控制结构与函数">第二章 控制结构与函数</h2>
<p><strong>2.1</strong><br>一个数字如果为正数，则它的signum为1;如果是负数,则signum为-1;如果为0,则signum为0.编写一个函数来计算这个值。</p>
<p>答：</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">def</span> sigNum(num: Int):Int = {</div><div class="line">	<span class="keyword">if</span> (num &gt; <span class="number">0</span>) <span class="number">1</span> <span class="keyword">else</span> <span class="keyword">if</span> (num &lt; <span class="number">0</span>) -<span class="number">1</span> <span class="keyword">else</span> <span class="number">0</span></div><div class="line">}</div><div class="line"></div><div class="line">println(signum(<span class="number">10000</span>));</div><div class="line">println(signum(-<span class="number">22</span>));</div><div class="line">println(signum(<span class="number">0</span>));</div></pre></td></tr></table></figure>

<p><strong>2.2</strong><br>一个空的块表达式{}的值是什么？类型是什么？</p>
<p>答：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">scala&gt; val x = {}</div><div class="line">x: Unit = ()</div></pre></td></tr></table></figure>

<p><strong>2.3</strong><br>指出在Scala中何种情况下赋值语句x=y=1是合法的。(提示：给x找个合适的类型定义)</p>
<p>答：<br>因为赋值语句的值是Unit型，所以x可定义为Unit型。</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">scala&gt; <span class="keyword">var</span> y = <span class="number">5</span></div><div class="line">y: Int = <span class="number">5</span></div><div class="line"></div><div class="line">scala&gt; <span class="keyword">var</span> x = {}</div><div class="line">x: Unit = ()</div><div class="line"></div><div class="line">scala&gt; x = y= <span class="number">1</span></div><div class="line">x: Unit = ()</div></pre></td></tr></table></figure>

<p><strong>2.4</strong><br>针对下列Java循环编写一个Scala版本:<br> for(int i=10;i&gt;=0;i—) System.out.println(i);</p>
<p>答：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">scala&gt; <span class="keyword">for</span>(i &lt;- <span class="number">0</span> to <span class="number">10</span> reverse) println(i)</div><div class="line">warning: there was one feature warning; re-run <span class="keyword">with</span> -feature <span class="keyword">for</span> details</div><div class="line"><span class="number">10</span></div><div class="line"><span class="number">9</span></div><div class="line"><span class="number">8</span></div><div class="line"><span class="number">7</span></div><div class="line"><span class="number">6</span></div><div class="line"><span class="number">5</span></div><div class="line"><span class="number">4</span></div><div class="line"><span class="number">3</span></div><div class="line"><span class="number">2</span></div><div class="line"><span class="number">1</span></div><div class="line"><span class="number">0</span></div></pre></td></tr></table></figure>

<p><strong>2.5</strong><br>编写一个过程countdown(n:Int)，打印从n到0的数字。</p>
<p>答：</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">scala&gt; <span class="keyword">def</span> countdown(n:Int){</div><div class="line">         <span class="keyword">for</span>(i &lt;- <span class="number">0</span> to n reverse){</div><div class="line">           println(i)</div><div class="line">         }</div><div class="line">       }</div><div class="line">warning: there was one feature warning; re-run <span class="keyword">with</span> -feature <span class="keyword">for</span> details</div><div class="line">countdown: (n: Int)Unit</div><div class="line"></div><div class="line">scala&gt; countdown(<span class="number">2</span>)</div><div class="line"><span class="number">2</span></div><div class="line"><span class="number">1</span></div><div class="line"><span class="number">0</span></div></pre></td></tr></table></figure>

<p><strong>2.6</strong><br>编写一个for循环,计算字符串中所有字母的Unicode代码的乘积。举例来说，”Hello”中所有字符串的乘积为9415087488L</p>
<p>答：</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">scala&gt; <span class="keyword">def</span> test(str:String):Long = {</div><div class="line">         <span class="keyword">var</span> result:Long = <span class="number">1</span></div><div class="line">         <span class="keyword">for</span>(i &lt;- str) result *= i</div><div class="line">         result</div><div class="line">       }</div><div class="line">test: (str: String)Long</div><div class="line"></div><div class="line">scala&gt; test(<span class="string">"oh,yeah"</span>)</div><div class="line">res5: Long = <span class="number">62621117315328</span></div></pre></td></tr></table></figure>

<p><strong>2.7</strong><br>同样是解决前一个练习的问题，但这次不使用循环。（提示：在Scaladoc中查看StringOps）</p>
<p>答：</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">def</span> test(str:String):Long = {</div><div class="line">  <span class="keyword">var</span> result:Long = <span class="number">1</span></div><div class="line">  str.foreach( ch =&gt; {result *= (ch.toLong)})</div><div class="line">  result</div><div class="line">}</div></pre></td></tr></table></figure>

<p><strong>2.8</strong><br>编写一个函数product(s:String), 计算前面习题中提到的乘积。</p>
<p>答：</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">def</span> product(str:String):Long = {</div><div class="line">  <span class="keyword">var</span> result:Long = <span class="number">1</span></div><div class="line">  str.foreach( result *= _.toLong )</div><div class="line">  result</div><div class="line">}</div></pre></td></tr></table></figure>

<p><strong>2.9</strong><br>把前一个练习中的函数改成递归函数。</p>
<p>答:</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">def</span> product(str:String):Long = {</div><div class="line">  <span class="keyword">var</span> result:Long = <span class="number">1</span></div><div class="line">  <span class="keyword">if</span> (str.length==<span class="number">1</span>)</div><div class="line">    result = str.head.toLong</div><div class="line">  <span class="keyword">else</span></div><div class="line">    result = str.head.toLong * product(str.tail)</div><div class="line">  result</div><div class="line">}</div></pre></td></tr></table></figure>

<p><strong>2.10</strong><br>编写函数计算x^n, 其中n为整数。使用如下的递归定义：</p>
<ul>
<li>x^n = y^2,如果</li>
<li>x^n = x*x^(n-1)</li>
<li>x^0 = 1</li>
<li>x^n = 1/x^(-n)</li>
</ul>
<p>答：</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">def</span> getPower(x:Double, n:Int):Double = {</div><div class="line">  <span class="keyword">if</span> (n == <span class="number">0</span> ) <span class="number">1</span></div><div class="line">  <span class="keyword">else</span> <span class="keyword">if</span> ( n&gt;<span class="number">0</span> && n % <span class="number">2</span> != <span class="number">0</span> ) x * getPower(x, n-<span class="number">1</span>)</div><div class="line">  <span class="keyword">else</span> <span class="keyword">if</span> (n &gt;<span class="number">0</span> && n % <span class="number">2</span> == <span class="number">0</span> ) getPower (x, n/<span class="number">2</span>) * getPower (x, n/<span class="number">2</span>)</div><div class="line">  <span class="keyword">else</span> <span class="number">1</span>/getPower( x, -n) </div><div class="line">}</div></pre></td></tr></table></figure>

<hr>
<p>参考：<br>《快学Scala》：<a href="http://book.douban.com/subject/19971952/" target="_blank" rel="external">http://book.douban.com/subject/19971952/</a></p>
<p><strong>（转载本站文章请注明作者和出处 Vernon Zheng(郑雪峰) – vernonzheng.com ，请勿用于任何商业用途）</strong></p>

        
      
    </div>

    <div class="post-footer">
      

      

      
      
    </div>
  </div>


    
  </div>

  
  <div class="pagination">
    <a class="extend prev" rel="prev" href="/">&laquo;</a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><a class="page-number" href="/page/4/">4</a><a class="extend next" rel="next" href="/page/3/">&raquo;</a>
  </div>


        </div>

        
      </div>


      
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <div id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      <div class="site-overview">
        <div class="site-author motion-element">
          <img class="site-author-image" src="/images/default_avatar.jpg" alt="Vern Zheng" />
          <p class="site-author-name">Vern Zheng</p>
        </div>
        <p class="site-description motion-element">tech | life | thiking | note</p>
        <div class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">32</span>
              <span class="site-state-item-name">posts</span>
            </a>
          </div>

          <div class="site-state-item site-state-categories">
            <a href="/categories">
              <span class="site-state-item-count">10</span>
              <span class="site-state-item-name">categories</span>
              </a>
          </div>

          <div class="site-state-item site-state-tags">
            <a href="/tags">
              <span class="site-state-item-count">24</span>
              <span class="site-state-item-name">tags</span>
              </a>
          </div>

        </div>

        
          <div class="feed-link motion-element">
            <a href="/atom.xml">
              <i class="menu-item-icon icon-feed"></i>
              RSS
            </a>
          </div>
        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
              <a href="https://github.com/vernonzheng" target="_blank">GitHub</a>
            </span>
            
              <span class="links-of-author-item">
              <a href="http://www.douban.com/people/vernonzheng/" target="_blank">DouBan</a>
            </span>
            
              <span class="links-of-author-item">
              <a href="http://www.zhihu.com/people/vernzheng" target="_blank">ZhiHu</a>
            </span>
            
              <span class="links-of-author-item">
              <a href="mailto:kevonzheng@gmail.com" target="_blank">Email</a>
            </span>
            
          
        </div>

        
        
          <div class="cc-license motion-element">
            <a href="http://creativecommons.org/licenses/by-nc-sa/4.0" class="cc-opacity" target="_blank">
              <img src="/images/cc-by-nc-sa.svg" alt="Creative Commons" />
            </a>
          </div>
        

      </div>

      

    </div>
  </div>


    </div>

    <div id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">
  
  &copy; &nbsp;  2014.12 - 
  2015
  <span class="with-love">
    <i class="icon-heart"></i>
  </span>
  <span class="author">Vern Zheng</span>
</div>

<div class="powered-by">
  Powered by <a class="theme-link" href="http://hexo.io">Hexo</a>
</div>

<div class="theme-info">
  Theme -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Mist
  </a>
</div>



      </div>
    </div>

    <div class="back-to-top"></div>
  </div>

  <script type="text/javascript" src="/vendors/jquery/index.js?v=2.1.3"></script>

  
  

  
  <script type="text/javascript" src="/vendors/fancybox/source/jquery.fancybox.pack.js"></script>
  <script type="text/javascript" src="/js/fancy-box.js"></script>


  <script type="text/javascript" src="/js/helpers.js"></script>
  

  <script type="text/javascript" src="/vendors/velocity/velocity.min.js"></script>
  <script type="text/javascript" src="/vendors/velocity/velocity.ui.min.js"></script>

  <script type="text/javascript" src="/js/motion_global.js" id="motion.global"></script>




  

  <script type="text/javascript">
    $(document).ready(function () {
      if (CONFIG.sidebar === 'always') {
        displaySidebar();
      }
    });
  </script>

  

  
  

  
    
  

  <script type="text/javascript">
    var duoshuoQuery = {short_name:"vernonzheng"};
    (function() {
      var ds = document.createElement('script');
      ds.type = 'text/javascript';ds.async = true;
      ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
      ds.charset = 'UTF-8';
      (document.getElementsByTagName('head')[0]
      || document.getElementsByTagName('body')[0]).appendChild(ds);
    })();
  </script>

  


  
  

</body>
</html>
